{"ast":null,"code":"/**\r\n * DevExtreme (viz/core/export.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.plugin = exports.ExportMenu = exports.combineMarkups = exports.exportWidgets = exports.getMarkup = exports.exportFromMarkup = void 0;\n\nvar _extend = require(\"../../core/utils/extend\");\n\nvar _window = require(\"../../core/utils/window\");\n\nvar _utils = require(\"./utils\");\n\nvar _exporter = require(\"../../exporter\");\n\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _themes = require(\"../themes\");\n\nvar _hover = require(\"../../events/hover\");\n\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\n\nvar _console = require(\"../../core/utils/console\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar pointerActions = [_pointer.default.down, _pointer.default.move].join(\" \");\nvar BUTTON_SIZE = 35;\nvar ICON_COORDS = [[9, 12, 26, 12, 26, 14, 9, 14], [9, 17, 26, 17, 26, 19, 9, 19], [9, 22, 26, 22, 26, 24, 9, 24]];\nvar LIST_PADDING_TOP = 4;\nvar LIST_WIDTH = 120;\nvar VERTICAL_TEXT_MARGIN = 8;\nvar HORIZONTAL_TEXT_MARGIN = 15;\nvar MENU_ITEM_HEIGHT = 30;\nvar LIST_STROKE_WIDTH = 1;\nvar MARGIN = 10;\nvar SHADOW_OFFSET = 2;\nvar SHADOW_BLUR = 3;\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\nvar EXPORT_DATA_KEY = \"export-element-type\";\nvar FORMAT_DATA_KEY = \"export-element-format\";\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\n\nfunction getValidFormats() {\n  var imageFormats = _exporter.image.testFormats(ALLOWED_IMAGE_FORMATS);\n\n  return {\n    unsupported: imageFormats.unsupported,\n    supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\n  };\n}\n\nfunction validateFormat(format, incidentOccurred, validFormats) {\n  validFormats = validFormats || getValidFormats();\n  format = String(format).toUpperCase();\n\n  if (validFormats.supported.indexOf(format) !== -1) {\n    return format;\n  }\n\n  if (validFormats.unsupported.indexOf(format) !== -1) {\n    incidentOccurred && incidentOccurred(\"W2108\", [format]);\n  }\n}\n\nfunction getCreatorFunc(format) {\n  if (\"SVG\" === format) {\n    return _exporter.svg.getData;\n  } else {\n    if (\"PDF\" === format) {\n      return _exporter.pdf.getData;\n    } else {\n      return _exporter.image.getData;\n    }\n  }\n}\n\nfunction _print(imageSrc, options) {\n  var document = (0, _window.getWindow)().document;\n  var iFrame = document.createElement(\"iframe\");\n  iFrame.onload = setPrint(imageSrc, options);\n  iFrame.style.position = \"fixed\";\n  iFrame.style.width = \"0\";\n  iFrame.style.height = \"0\";\n  iFrame.style.right = \"0\";\n  iFrame.style.bottom = \"0\";\n  document.body.appendChild(iFrame);\n}\n\nfunction setPrint(imageSrc, options) {\n  return function () {\n    var _this = this;\n\n    var window = this.contentWindow;\n    var img = window.document.createElement(\"img\");\n    window.document.body.appendChild(img);\n\n    var removeFrame = function removeFrame() {\n      _this.parentElement.removeChild(_this);\n    };\n\n    img.addEventListener(\"load\", function () {\n      window.focus();\n      window.print();\n    });\n    img.addEventListener(\"error\", removeFrame);\n    window.addEventListener(\"afterprint\", function () {\n      setTimeout(removeFrame, 0);\n    });\n    img.src = imageSrc;\n  };\n}\n\nfunction getItemAttributes(options, type, itemIndex) {\n  var x = BUTTON_SIZE - LIST_WIDTH;\n  var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\n  var attr = {\n    rect: {\n      width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\n      height: MENU_ITEM_HEIGHT,\n      x: x + LIST_STROKE_WIDTH,\n      y: y\n    },\n    text: {\n      x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\n      y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\n    }\n  };\n\n  if (\"printing\" === type) {\n    attr.separator = {\n      stroke: options.button.default.borderColor,\n      \"stroke-width\": LIST_STROKE_WIDTH,\n      cursor: \"pointer\",\n      sharp: \"v\",\n      d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\n    };\n  }\n\n  return attr;\n}\n\nfunction createMenuItem(renderer, options, settings) {\n  var itemData = {};\n  var type = settings.type;\n  var format = settings.format;\n  var attr = getItemAttributes(options, type, settings.itemIndex);\n  var fontStyle = (0, _utils.patchFontOptions)(options.font);\n  fontStyle[\"pointer-events\"] = \"none\";\n  var menuItem = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-list-item\"\n  });\n  itemData[EXPORT_DATA_KEY] = type;\n\n  if (format) {\n    itemData[FORMAT_DATA_KEY] = format;\n  }\n\n  var rect = renderer.rect();\n  rect.attr(attr.rect).css({\n    cursor: \"pointer\",\n    \"pointer-events\": \"all\"\n  }).data(itemData);\n  rect.on(_hover.start + \".export\", function () {\n    return rect.attr({\n      fill: options.button.hover.backgroundColor\n    });\n  }).on(_hover.end + \".export\", function () {\n    return rect.attr({\n      fill: null\n    });\n  });\n  rect.append(menuItem);\n  var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\n\n  if (\"printing\" === type) {\n    renderer.path(null, \"line\").attr(attr.separator).append(menuItem);\n  }\n\n  return {\n    g: menuItem,\n    rect: rect,\n    resetState: function resetState() {\n      return rect.attr({\n        fill: null\n      });\n    },\n    fixPosition: function fixPosition() {\n      var textBBox = text.getBBox();\n      text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0));\n    }\n  };\n}\n\nfunction createMenuItems(renderer, options) {\n  var items = [];\n\n  if (options.printingEnabled) {\n    items.push(createMenuItem(renderer, options, {\n      type: \"printing\",\n      text: _message.default.format(\"vizExport-printingButtonText\"),\n      itemIndex: items.length\n    }));\n  }\n\n  items = options.formats.reduce(function (r, format) {\n    r.push(createMenuItem(renderer, options, {\n      type: \"exporting\",\n      text: _message.default.getFormatter(\"vizExport-exportButtonText\")(format),\n      format: format,\n      itemIndex: r.length\n    }));\n    return r;\n  }, items);\n  return items;\n}\n\nfunction getBackgroundColorFromMarkup(markup) {\n  var parsedMarkup = GET_COLOR_REGEX.exec(markup);\n  return null === parsedMarkup || void 0 === parsedMarkup ? void 0 : parsedMarkup[1];\n}\n\nvar exportFromMarkup = function exportFromMarkup(markup, options) {\n  options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\n  options.fileName = options.fileName || \"file\";\n  options.exportingAction = options.onExporting;\n  options.exportedAction = options.onExported;\n  options.fileSavingAction = options.onFileSaving;\n  options.margin = (0, _type.isDefined)(options.margin) ? options.margin : MARGIN;\n  options.backgroundColor = (0, _type.isDefined)(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || (0, _themes.getTheme)().backgroundColor;\n  (0, _exporter.export)(markup, options, getCreatorFunc(options.format));\n};\n\nexports.exportFromMarkup = exportFromMarkup;\n\nvar getMarkup = function getMarkup(widgets) {\n  return combineMarkups(widgets).markup;\n};\n\nexports.getMarkup = getMarkup;\n\nvar exportWidgets = function exportWidgets(widgets, options) {\n  options = options || {};\n  var markupInfo = combineMarkups(widgets, {\n    gridLayout: options.gridLayout,\n    verticalAlignment: options.verticalAlignment,\n    horizontalAlignment: options.horizontalAlignment\n  });\n  options.width = markupInfo.width;\n  options.height = markupInfo.height;\n  exportFromMarkup(markupInfo.markup, options);\n};\n\nexports.exportWidgets = exportWidgets;\n\nvar combineMarkups = function combineMarkups(widgets) {\n  var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\n\n  if (!Array.isArray(widgets)) {\n    widgets = [[widgets]];\n  } else {\n    if (!Array.isArray(widgets[0])) {\n      widgets = widgets.map(function (item) {\n        return [item];\n      });\n    }\n  }\n\n  var compactView = !options.gridLayout;\n  var exportItems = widgets.reduce(function (r, row, rowIndex) {\n    var rowInfo = row.reduce(function (r, item, colIndex) {\n      var size = item.getSize();\n      var backgroundColor = item.option(\"backgroundColor\") || (0, _themes.getTheme)(item.option(\"theme\")).backgroundColor;\n      backgroundColor && r.backgroundColors.indexOf(backgroundColor) === -1 && r.backgroundColors.push(backgroundColor);\n      r.hOffset = r.width;\n      r.width += size.width;\n      r.height = Math.max(r.height, size.height);\n      r.itemWidth = Math.max(r.itemWidth, size.width);\n      r.items.push({\n        markup: item.svg(),\n        width: size.width,\n        height: size.height,\n        c: colIndex,\n        r: rowIndex,\n        hOffset: r.hOffset\n      });\n      return r;\n    }, {\n      items: [],\n      height: 0,\n      itemWidth: 0,\n      hOffset: 0,\n      width: 0,\n      backgroundColors: r.backgroundColors\n    });\n    r.rowOffsets.push(r.totalHeight);\n    r.rowHeights.push(rowInfo.height);\n    r.totalHeight += rowInfo.height;\n    r.items = r.items.concat(rowInfo.items);\n    r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\n    r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\n    r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\n    return r;\n  }, {\n    items: [],\n    rowOffsets: [],\n    rowHeights: [],\n    itemWidth: 0,\n    totalHeight: 0,\n    maxItemLen: 0,\n    totalWidth: 0,\n    backgroundColors: []\n  });\n  var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\n\n  var getVOffset = function getVOffset(item) {\n    var align = options.verticalAlignment;\n    var dy = exportItems.rowHeights[item.r] - item.height;\n    return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0);\n  };\n\n  var getHOffset = function getHOffset(item) {\n    if (compactView) {\n      return item.hOffset;\n    }\n\n    var align = options.horizontalAlignment;\n    var colWidth = exportItems.itemWidth;\n    var dx = colWidth - item.width;\n    return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0);\n  };\n\n  var totalHeight = exportItems.totalHeight;\n  var totalWidth = exportItems.totalWidth;\n  return {\n    markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(function (item) {\n      return '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\");\n    }).join(\"\") + \"</svg>\",\n    width: totalWidth,\n    height: totalHeight\n  };\n};\n\nexports.combineMarkups = combineMarkups;\n\nvar ExportMenu = function ExportMenu(params) {\n  var renderer = this._renderer = params.renderer;\n  this._incidentOccurred = params.incidentOccurred;\n  this._exportTo = params.exportTo;\n  this._print = params.print;\n  this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\n\n  this._shadow.attr({\n    opacity: .8\n  });\n\n  this._group = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS,\n    \"hidden-for-export\": true\n  }).linkOn(renderer.root, {\n    name: \"export-menu\",\n    after: \"peripheral\"\n  });\n  this._buttonGroup = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-button\"\n  }).append(this._group);\n  this._listGroup = renderer.g().attr({\n    \"class\": EXPORT_CSS_CLASS + \"-list\"\n  }).append(this._group);\n  this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\n\n  this._overlay.attr({\n    \"stroke-width\": LIST_STROKE_WIDTH,\n    cursor: \"pointer\",\n    rx: 4,\n    ry: 4,\n    filter: this._shadow.id\n  });\n\n  this._overlay.data({\n    \"export-element-type\": \"list\"\n  });\n\n  this.validFormats = getValidFormats();\n\n  this._subscribeEvents();\n};\n\nexports.ExportMenu = ExportMenu;\n(0, _extend.extend)(ExportMenu.prototype, {\n  getLayoutOptions: function getLayoutOptions() {\n    if (this._hiddenDueToLayout) {\n      return {\n        width: 0,\n        height: 0,\n        cutSide: \"vertical\",\n        cutLayoutSide: \"top\"\n      };\n    }\n\n    var bBox = this._buttonGroup.getBBox();\n\n    bBox.cutSide = \"vertical\";\n    bBox.cutLayoutSide = \"top\";\n    bBox.height += MARGIN;\n    bBox.position = {\n      vertical: \"top\",\n      horizontal: \"right\"\n    };\n    bBox.verticalAlignment = \"top\";\n    bBox.horizontalAlignment = \"right\";\n    return bBox;\n  },\n  shift: function shift(_, y) {\n    this._group.attr({\n      translateY: this._group.attr(\"translateY\") + y\n    });\n  },\n  draw: function draw(width, height, canvas) {\n    this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\n\n    var layoutOptions = this.getLayoutOptions();\n\n    if (layoutOptions.width > width || layoutOptions.height > height) {\n      this.freeSpace();\n    }\n\n    return this;\n  },\n  show: function show() {\n    this._group.linkAppend();\n  },\n  hide: function hide() {\n    this._group.linkRemove();\n  },\n  setOptions: function setOptions(options) {\n    var _this2 = this;\n\n    this._options = options;\n\n    if (options.formats) {\n      options.formats = options.formats.reduce(function (r, format) {\n        format = validateFormat(format, _this2._incidentOccurred, _this2.validFormats);\n        format && r.push(format);\n        return r;\n      }, []);\n    } else {\n      options.formats = this.validFormats.supported.slice();\n    }\n\n    options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\n\n    if (options.enabled && (options.formats.length || options.printingEnabled)) {\n      this.show();\n\n      this._updateButton();\n\n      this._updateList();\n\n      this._hideList();\n    } else {\n      this.hide();\n    }\n  },\n  dispose: function dispose() {\n    this._unsubscribeEvents();\n\n    this._group.linkRemove().linkOff();\n\n    this._group.dispose();\n\n    this._shadow.dispose();\n  },\n  layoutOptions: function layoutOptions() {\n    return this._options.enabled && {\n      horizontalAlignment: \"right\",\n      verticalAlignment: \"top\",\n      weak: true\n    };\n  },\n  measure: function measure() {\n    this._fillSpace();\n\n    var margin = this._options.button.margin;\n    return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom];\n  },\n  move: function move(rect) {\n    var margin = this._options.button.margin;\n\n    this._group.attr({\n      translateX: Math.round(rect[0]) + margin.left,\n      translateY: Math.round(rect[1]) + margin.top\n    });\n  },\n  _fillSpace: function _fillSpace() {\n    this._hiddenDueToLayout = false;\n    this.show();\n  },\n  freeSpace: function freeSpace() {\n    this._incidentOccurred(\"W2107\");\n\n    this._hiddenDueToLayout = true;\n    this.hide();\n  },\n  _hideList: function _hideList() {\n    this._listGroup.remove();\n\n    this._listShown = false;\n\n    this._setButtonState(\"default\");\n\n    this._menuItems.forEach(function (item) {\n      return item.resetState();\n    });\n  },\n  _showList: function _showList() {\n    this._listGroup.append(this._group);\n\n    this._listShown = true;\n\n    this._menuItems.forEach(function (item) {\n      return item.fixPosition();\n    });\n  },\n  _setButtonState: function _setButtonState(state) {\n    var style = this._options.button[state];\n\n    this._button.attr({\n      stroke: style.borderColor,\n      fill: style.backgroundColor\n    });\n\n    this._icon.attr({\n      fill: style.color\n    });\n  },\n  _subscribeEvents: function _subscribeEvents() {\n    var _this3 = this;\n\n    this._renderer.root.on(_pointer.default.up + \".export\", function (e) {\n      var elementType = e.target[EXPORT_DATA_KEY];\n\n      if (!elementType) {\n        if (_this3._button) {\n          _this3._hideList();\n        }\n\n        return;\n      }\n\n      if (\"button\" === elementType) {\n        if (_this3._listShown) {\n          _this3._setButtonState(\"default\");\n\n          _this3._hideList();\n        } else {\n          _this3._setButtonState(\"focus\");\n\n          _this3._showList();\n        }\n      } else {\n        if (\"printing\" === elementType) {\n          _this3._print();\n\n          _this3._hideList();\n        } else {\n          if (\"exporting\" === elementType) {\n            _this3._exportTo(e.target[FORMAT_DATA_KEY]);\n\n            _this3._hideList();\n          }\n        }\n      }\n    });\n\n    this._listGroup.on(pointerActions, function (e) {\n      return e.stopPropagation();\n    });\n\n    this._buttonGroup.on(_pointer.default.enter, function () {\n      return _this3._setButtonState(\"hover\");\n    });\n\n    this._buttonGroup.on(_pointer.default.leave, function () {\n      return _this3._setButtonState(_this3._listShown ? \"focus\" : \"default\");\n    });\n\n    this._buttonGroup.on(_pointer.default.down + \".export\", function () {\n      return _this3._setButtonState(\"active\");\n    });\n  },\n  _unsubscribeEvents: function _unsubscribeEvents() {\n    this._renderer.root.off(\".export\");\n\n    this._listGroup.off();\n\n    this._buttonGroup.off();\n  },\n  _updateButton: function _updateButton() {\n    var renderer = this._renderer;\n    var options = this._options;\n    var exportData = {\n      \"export-element-type\": \"button\"\n    };\n\n    if (!this._button) {\n      this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\n\n      this._button.attr({\n        rx: 4,\n        ry: 4,\n        fill: options.button.default.backgroundColor,\n        stroke: options.button.default.borderColor,\n        \"stroke-width\": 1,\n        cursor: \"pointer\"\n      });\n\n      this._button.data(exportData);\n\n      this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\n\n      this._icon.attr({\n        fill: options.button.default.color,\n        cursor: \"pointer\"\n      });\n\n      this._icon.data(exportData);\n\n      this._buttonGroup.setTitle(_message.default.format(\"vizExport-titleMenuText\"));\n    }\n  },\n  _updateList: function _updateList() {\n    var options = this._options;\n    var buttonDefault = options.button.default;\n    var listGroup = this._listGroup;\n    var items = createMenuItems(this._renderer, options);\n\n    this._shadow.attr({\n      color: options.shadowColor\n    });\n\n    this._overlay.attr({\n      height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\n      fill: buttonDefault.backgroundColor,\n      stroke: buttonDefault.borderColor\n    });\n\n    listGroup.clear();\n\n    this._overlay.append(listGroup);\n\n    items.forEach(function (item) {\n      return item.g.append(listGroup);\n    });\n    this._menuItems = items;\n  }\n});\n\nfunction getExportOptions(widget, exportOptions, fileName, format) {\n  if (format || exportOptions.format) {\n    format = validateFormat(format || exportOptions.format, widget._incidentOccurred);\n  }\n\n  return {\n    format: format || DEFAULT_EXPORT_FORMAT,\n    fileName: fileName || exportOptions.fileName || \"file\",\n    proxyUrl: exportOptions.proxyUrl,\n    backgroundColor: exportOptions.backgroundColor,\n    width: widget._canvas.width,\n    height: widget._canvas.height,\n    margin: exportOptions.margin,\n    svgToCanvas: exportOptions.svgToCanvas,\n    forceProxy: exportOptions.forceProxy,\n    exportingAction: widget._createActionByOption(\"onExporting\"),\n    exportedAction: widget._createActionByOption(\"onExported\"),\n    fileSavingAction: widget._createActionByOption(\"onFileSaving\")\n  };\n}\n\nvar plugin = {\n  name: \"export\",\n  init: function init() {\n    var _this4 = this;\n\n    this._exportMenu = new ExportMenu({\n      renderer: this._renderer,\n      incidentOccurred: this._incidentOccurred,\n      print: function print() {\n        return _this4.print();\n      },\n      exportTo: function exportTo(format) {\n        return _this4.exportTo(void 0, format);\n      }\n    });\n\n    this._layout.add(this._exportMenu);\n  },\n  dispose: function dispose() {\n    this._exportMenu.dispose();\n  },\n  members: {\n    _getExportMenuOptions: function _getExportMenuOptions() {\n      return (0, _extend.extend)({}, this._getOption(\"export\"), {\n        rtl: this._getOption(\"rtlEnabled\", true)\n      });\n    },\n    _disablePointerEvents: function _disablePointerEvents() {\n      var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\n\n      this._renderer.root.attr({\n        \"pointer-events\": \"none\"\n      });\n\n      return pointerEventsValue;\n    },\n    exportTo: function exportTo(fileName, format) {\n      var _this5 = this;\n\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\n      menu && menu.hide();\n\n      var pointerEventsValue = this._disablePointerEvents();\n\n      var promise = (0, _exporter.export)(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function () {\n        _this5._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n      menu && menu.show();\n      return promise;\n    },\n    print: function print() {\n      var _this6 = this;\n\n      var menu = this._exportMenu;\n      var options = getExportOptions(this, this._getOption(\"export\") || {});\n      options.exportingAction = null;\n      options.exportedAction = null;\n      options.margin = 0;\n      options.format = \"PNG\";\n      options.forceProxy = true;\n\n      options.fileSavingAction = function (eventArgs) {\n        _print(\"data:image/png;base64,\".concat(eventArgs.data), {\n          __test: options.__test\n        });\n\n        eventArgs.cancel = true;\n      };\n\n      var pointerEventsValue = this._disablePointerEvents();\n\n      menu && menu.hide();\n      var promise = (0, _exporter.export)(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function () {\n        _this6._renderer.root.attr({\n          \"pointer-events\": pointerEventsValue\n        });\n      });\n      menu && menu.show();\n      return promise;\n    }\n  },\n  customize: function customize(constructor) {\n    var proto = constructor.prototype;\n    constructor.addChange({\n      code: \"EXPORT\",\n      handler: function handler() {\n        this._exportMenu.setOptions(this._getExportMenuOptions());\n\n        this._change([\"LAYOUT\"]);\n      },\n      isThemeDependent: true,\n      isOptionChange: true,\n      option: \"export\"\n    });\n    proto._optionChangesMap.onExporting = \"EXPORT\";\n    proto._optionChangesMap.onExported = \"EXPORT\";\n    proto._optionChangesMap.onFileSaving = \"EXPORT\";\n  },\n  fontFields: [\"export.font\"]\n};\nexports.plugin = plugin;","map":{"version":3,"sources":["E:/Monday.com/quickstart-react/node_modules/devextreme/viz/core/export.js"],"names":["exports","plugin","ExportMenu","combineMarkups","exportWidgets","getMarkup","exportFromMarkup","_extend","require","_window","_utils","_exporter","_message","_interopRequireDefault","_type","_themes","_hover","_pointer","_console","obj","__esModule","pointerActions","default","down","move","join","BUTTON_SIZE","ICON_COORDS","LIST_PADDING_TOP","LIST_WIDTH","VERTICAL_TEXT_MARGIN","HORIZONTAL_TEXT_MARGIN","MENU_ITEM_HEIGHT","LIST_STROKE_WIDTH","MARGIN","SHADOW_OFFSET","SHADOW_BLUR","DEFAULT_EXPORT_FORMAT","ALLOWED_IMAGE_FORMATS","ALLOWED_EXTRA_FORMATS","EXPORT_CSS_CLASS","EXPORT_DATA_KEY","FORMAT_DATA_KEY","GET_COLOR_REGEX","getValidFormats","imageFormats","image","testFormats","unsupported","supported","concat","validateFormat","format","incidentOccurred","validFormats","String","toUpperCase","indexOf","getCreatorFunc","svg","getData","pdf","_print","imageSrc","options","document","getWindow","iFrame","createElement","onload","setPrint","style","position","width","height","right","bottom","body","appendChild","_this","window","contentWindow","img","removeFrame","parentElement","removeChild","addEventListener","focus","print","setTimeout","src","getItemAttributes","type","itemIndex","x","y","attr","rect","text","rtl","separator","stroke","button","borderColor","cursor","sharp","d","createMenuItem","renderer","settings","itemData","fontStyle","patchFontOptions","font","menuItem","g","css","data","on","start","fill","hover","backgroundColor","end","append","path","resetState","fixPosition","textBBox","getBBox","createMenuItems","items","printingEnabled","push","length","formats","reduce","r","getFormatter","getBackgroundColorFromMarkup","markup","parsedMarkup","exec","fileName","exportingAction","onExporting","exportedAction","onExported","fileSavingAction","onFileSaving","margin","isDefined","getTheme","export","widgets","markupInfo","gridLayout","verticalAlignment","horizontalAlignment","arguments","Array","isArray","map","item","compactView","exportItems","row","rowIndex","rowInfo","colIndex","size","getSize","option","backgroundColors","hOffset","Math","max","itemWidth","c","rowOffsets","totalHeight","rowHeights","maxItemLen","totalWidth","getVOffset","align","dy","getHOffset","colWidth","dx","params","_renderer","_incidentOccurred","_exportTo","exportTo","_shadow","shadowFilter","opacity","_group","linkOn","root","name","after","_buttonGroup","_listGroup","_overlay","rx","ry","filter","id","_subscribeEvents","extend","prototype","getLayoutOptions","_hiddenDueToLayout","cutSide","cutLayoutSide","bBox","vertical","horizontal","shift","_","translateY","draw","canvas","left","floor","layoutOptions","freeSpace","show","linkAppend","hide","linkRemove","setOptions","_this2","_options","slice","enabled","_updateButton","_updateList","_hideList","dispose","_unsubscribeEvents","linkOff","weak","measure","_fillSpace","top","translateX","round","remove","_listShown","_setButtonState","_menuItems","forEach","_showList","state","_button","_icon","color","_this3","up","e","elementType","target","stopPropagation","enter","leave","off","exportData","setTitle","buttonDefault","listGroup","shadowColor","clear","getExportOptions","widget","exportOptions","proxyUrl","_canvas","svgToCanvas","forceProxy","_createActionByOption","init","_this4","_exportMenu","_layout","add","members","_getExportMenuOptions","_getOption","_disablePointerEvents","pointerEventsValue","_this5","menu","promise","element","fail","logger","error","always","_this6","eventArgs","__test","cancel","customize","constructor","proto","addChange","code","handler","_change","isThemeDependent","isOptionChange","_optionChangesMap","fontFields"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/core/export.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.plugin = exports.ExportMenu = exports.combineMarkups = exports.exportWidgets = exports.getMarkup = exports.exportFromMarkup = void 0;\r\nvar _extend = require(\"../../core/utils/extend\");\r\nvar _window = require(\"../../core/utils/window\");\r\nvar _utils = require(\"./utils\");\r\nvar _exporter = require(\"../../exporter\");\r\nvar _message = _interopRequireDefault(require(\"../../localization/message\"));\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _themes = require(\"../themes\");\r\nvar _hover = require(\"../../events/hover\");\r\nvar _pointer = _interopRequireDefault(require(\"../../events/pointer\"));\r\nvar _console = require(\"../../core/utils/console\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar pointerActions = [_pointer.default.down, _pointer.default.move].join(\" \");\r\nvar BUTTON_SIZE = 35;\r\nvar ICON_COORDS = [\r\n    [9, 12, 26, 12, 26, 14, 9, 14],\r\n    [9, 17, 26, 17, 26, 19, 9, 19],\r\n    [9, 22, 26, 22, 26, 24, 9, 24]\r\n];\r\nvar LIST_PADDING_TOP = 4;\r\nvar LIST_WIDTH = 120;\r\nvar VERTICAL_TEXT_MARGIN = 8;\r\nvar HORIZONTAL_TEXT_MARGIN = 15;\r\nvar MENU_ITEM_HEIGHT = 30;\r\nvar LIST_STROKE_WIDTH = 1;\r\nvar MARGIN = 10;\r\nvar SHADOW_OFFSET = 2;\r\nvar SHADOW_BLUR = 3;\r\nvar DEFAULT_EXPORT_FORMAT = \"PNG\";\r\nvar ALLOWED_IMAGE_FORMATS = [DEFAULT_EXPORT_FORMAT, \"JPEG\", \"GIF\"];\r\nvar ALLOWED_EXTRA_FORMATS = [\"PDF\", \"SVG\"];\r\nvar EXPORT_CSS_CLASS = \"dx-export-menu\";\r\nvar EXPORT_DATA_KEY = \"export-element-type\";\r\nvar FORMAT_DATA_KEY = \"export-element-format\";\r\nvar GET_COLOR_REGEX = /data-backgroundcolor=\"([^\"]*)\"/;\r\n\r\nfunction getValidFormats() {\r\n    var imageFormats = _exporter.image.testFormats(ALLOWED_IMAGE_FORMATS);\r\n    return {\r\n        unsupported: imageFormats.unsupported,\r\n        supported: imageFormats.supported.concat(ALLOWED_EXTRA_FORMATS)\r\n    }\r\n}\r\n\r\nfunction validateFormat(format, incidentOccurred, validFormats) {\r\n    validFormats = validFormats || getValidFormats();\r\n    format = String(format).toUpperCase();\r\n    if (validFormats.supported.indexOf(format) !== -1) {\r\n        return format\r\n    }\r\n    if (validFormats.unsupported.indexOf(format) !== -1) {\r\n        incidentOccurred && incidentOccurred(\"W2108\", [format])\r\n    }\r\n}\r\n\r\nfunction getCreatorFunc(format) {\r\n    if (\"SVG\" === format) {\r\n        return _exporter.svg.getData\r\n    } else {\r\n        if (\"PDF\" === format) {\r\n            return _exporter.pdf.getData\r\n        } else {\r\n            return _exporter.image.getData\r\n        }\r\n    }\r\n}\r\n\r\nfunction _print(imageSrc, options) {\r\n    var document = (0, _window.getWindow)().document;\r\n    var iFrame = document.createElement(\"iframe\");\r\n    iFrame.onload = setPrint(imageSrc, options);\r\n    iFrame.style.position = \"fixed\";\r\n    iFrame.style.width = \"0\";\r\n    iFrame.style.height = \"0\";\r\n    iFrame.style.right = \"0\";\r\n    iFrame.style.bottom = \"0\";\r\n    document.body.appendChild(iFrame)\r\n}\r\n\r\nfunction setPrint(imageSrc, options) {\r\n    return function() {\r\n        var _this = this;\r\n        var window = this.contentWindow;\r\n        var img = window.document.createElement(\"img\");\r\n        window.document.body.appendChild(img);\r\n        var removeFrame = function() {\r\n            _this.parentElement.removeChild(_this)\r\n        };\r\n        img.addEventListener(\"load\", function() {\r\n            window.focus();\r\n            window.print()\r\n        });\r\n        img.addEventListener(\"error\", removeFrame);\r\n        window.addEventListener(\"afterprint\", function() {\r\n            setTimeout(removeFrame, 0)\r\n        });\r\n        img.src = imageSrc\r\n    }\r\n}\r\n\r\nfunction getItemAttributes(options, type, itemIndex) {\r\n    var x = BUTTON_SIZE - LIST_WIDTH;\r\n    var y = BUTTON_SIZE + LIST_PADDING_TOP + LIST_STROKE_WIDTH + itemIndex * MENU_ITEM_HEIGHT;\r\n    var attr = {\r\n        rect: {\r\n            width: LIST_WIDTH - 2 * LIST_STROKE_WIDTH,\r\n            height: MENU_ITEM_HEIGHT,\r\n            x: x + LIST_STROKE_WIDTH,\r\n            y: y\r\n        },\r\n        text: {\r\n            x: x + (options.rtl ? LIST_WIDTH - HORIZONTAL_TEXT_MARGIN : HORIZONTAL_TEXT_MARGIN),\r\n            y: y + MENU_ITEM_HEIGHT - VERTICAL_TEXT_MARGIN\r\n        }\r\n    };\r\n    if (\"printing\" === type) {\r\n        attr.separator = {\r\n            stroke: options.button.default.borderColor,\r\n            \"stroke-width\": LIST_STROKE_WIDTH,\r\n            cursor: \"pointer\",\r\n            sharp: \"v\",\r\n            d: \"M \" + x + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH) + \" L \" + (x + LIST_WIDTH) + \" \" + (y + MENU_ITEM_HEIGHT - LIST_STROKE_WIDTH)\r\n        }\r\n    }\r\n    return attr\r\n}\r\n\r\nfunction createMenuItem(renderer, options, settings) {\r\n    var itemData = {};\r\n    var type = settings.type;\r\n    var format = settings.format;\r\n    var attr = getItemAttributes(options, type, settings.itemIndex);\r\n    var fontStyle = (0, _utils.patchFontOptions)(options.font);\r\n    fontStyle[\"pointer-events\"] = \"none\";\r\n    var menuItem = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-list-item\"\r\n    });\r\n    itemData[EXPORT_DATA_KEY] = type;\r\n    if (format) {\r\n        itemData[FORMAT_DATA_KEY] = format\r\n    }\r\n    var rect = renderer.rect();\r\n    rect.attr(attr.rect).css({\r\n        cursor: \"pointer\",\r\n        \"pointer-events\": \"all\"\r\n    }).data(itemData);\r\n    rect.on(_hover.start + \".export\", function() {\r\n        return rect.attr({\r\n            fill: options.button.hover.backgroundColor\r\n        })\r\n    }).on(_hover.end + \".export\", function() {\r\n        return rect.attr({\r\n            fill: null\r\n        })\r\n    });\r\n    rect.append(menuItem);\r\n    var text = renderer.text(settings.text).css(fontStyle).attr(attr.text).append(menuItem);\r\n    if (\"printing\" === type) {\r\n        renderer.path(null, \"line\").attr(attr.separator).append(menuItem)\r\n    }\r\n    return {\r\n        g: menuItem,\r\n        rect: rect,\r\n        resetState: function() {\r\n            return rect.attr({\r\n                fill: null\r\n            })\r\n        },\r\n        fixPosition: function() {\r\n            var textBBox = text.getBBox();\r\n            text.move(attr.text.x - textBBox.x - (options.rtl ? textBBox.width : 0))\r\n        }\r\n    }\r\n}\r\n\r\nfunction createMenuItems(renderer, options) {\r\n    var items = [];\r\n    if (options.printingEnabled) {\r\n        items.push(createMenuItem(renderer, options, {\r\n            type: \"printing\",\r\n            text: _message.default.format(\"vizExport-printingButtonText\"),\r\n            itemIndex: items.length\r\n        }))\r\n    }\r\n    items = options.formats.reduce(function(r, format) {\r\n        r.push(createMenuItem(renderer, options, {\r\n            type: \"exporting\",\r\n            text: _message.default.getFormatter(\"vizExport-exportButtonText\")(format),\r\n            format: format,\r\n            itemIndex: r.length\r\n        }));\r\n        return r\r\n    }, items);\r\n    return items\r\n}\r\n\r\nfunction getBackgroundColorFromMarkup(markup) {\r\n    var parsedMarkup = GET_COLOR_REGEX.exec(markup);\r\n    return null === parsedMarkup || void 0 === parsedMarkup ? void 0 : parsedMarkup[1]\r\n}\r\nvar exportFromMarkup = function(markup, options) {\r\n    options.format = validateFormat(options.format) || DEFAULT_EXPORT_FORMAT;\r\n    options.fileName = options.fileName || \"file\";\r\n    options.exportingAction = options.onExporting;\r\n    options.exportedAction = options.onExported;\r\n    options.fileSavingAction = options.onFileSaving;\r\n    options.margin = (0, _type.isDefined)(options.margin) ? options.margin : MARGIN;\r\n    options.backgroundColor = (0, _type.isDefined)(options.backgroundColor) ? options.backgroundColor : getBackgroundColorFromMarkup(markup) || (0, _themes.getTheme)().backgroundColor;\r\n    (0, _exporter.export)(markup, options, getCreatorFunc(options.format))\r\n};\r\nexports.exportFromMarkup = exportFromMarkup;\r\nvar getMarkup = function(widgets) {\r\n    return combineMarkups(widgets).markup\r\n};\r\nexports.getMarkup = getMarkup;\r\nvar exportWidgets = function(widgets, options) {\r\n    options = options || {};\r\n    var markupInfo = combineMarkups(widgets, {\r\n        gridLayout: options.gridLayout,\r\n        verticalAlignment: options.verticalAlignment,\r\n        horizontalAlignment: options.horizontalAlignment\r\n    });\r\n    options.width = markupInfo.width;\r\n    options.height = markupInfo.height;\r\n    exportFromMarkup(markupInfo.markup, options)\r\n};\r\nexports.exportWidgets = exportWidgets;\r\nvar combineMarkups = function(widgets) {\r\n    var options = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {};\r\n    if (!Array.isArray(widgets)) {\r\n        widgets = [\r\n            [widgets]\r\n        ]\r\n    } else {\r\n        if (!Array.isArray(widgets[0])) {\r\n            widgets = widgets.map(function(item) {\r\n                return [item]\r\n            })\r\n        }\r\n    }\r\n    var compactView = !options.gridLayout;\r\n    var exportItems = widgets.reduce(function(r, row, rowIndex) {\r\n        var rowInfo = row.reduce(function(r, item, colIndex) {\r\n            var size = item.getSize();\r\n            var backgroundColor = item.option(\"backgroundColor\") || (0, _themes.getTheme)(item.option(\"theme\")).backgroundColor;\r\n            backgroundColor && r.backgroundColors.indexOf(backgroundColor) === -1 && r.backgroundColors.push(backgroundColor);\r\n            r.hOffset = r.width;\r\n            r.width += size.width;\r\n            r.height = Math.max(r.height, size.height);\r\n            r.itemWidth = Math.max(r.itemWidth, size.width);\r\n            r.items.push({\r\n                markup: item.svg(),\r\n                width: size.width,\r\n                height: size.height,\r\n                c: colIndex,\r\n                r: rowIndex,\r\n                hOffset: r.hOffset\r\n            });\r\n            return r\r\n        }, {\r\n            items: [],\r\n            height: 0,\r\n            itemWidth: 0,\r\n            hOffset: 0,\r\n            width: 0,\r\n            backgroundColors: r.backgroundColors\r\n        });\r\n        r.rowOffsets.push(r.totalHeight);\r\n        r.rowHeights.push(rowInfo.height);\r\n        r.totalHeight += rowInfo.height;\r\n        r.items = r.items.concat(rowInfo.items);\r\n        r.itemWidth = Math.max(r.itemWidth, rowInfo.itemWidth);\r\n        r.maxItemLen = Math.max(r.maxItemLen, rowInfo.items.length);\r\n        r.totalWidth = compactView ? Math.max(r.totalWidth, rowInfo.width) : r.maxItemLen * r.itemWidth;\r\n        return r\r\n    }, {\r\n        items: [],\r\n        rowOffsets: [],\r\n        rowHeights: [],\r\n        itemWidth: 0,\r\n        totalHeight: 0,\r\n        maxItemLen: 0,\r\n        totalWidth: 0,\r\n        backgroundColors: []\r\n    });\r\n    var backgroundColor = 'data-backgroundcolor=\"'.concat(1 === exportItems.backgroundColors.length ? exportItems.backgroundColors[0] : \"\", '\" ');\r\n    var getVOffset = function(item) {\r\n        var align = options.verticalAlignment;\r\n        var dy = exportItems.rowHeights[item.r] - item.height;\r\n        return exportItems.rowOffsets[item.r] + (\"bottom\" === align ? dy : \"center\" === align ? dy / 2 : 0)\r\n    };\r\n    var getHOffset = function(item) {\r\n        if (compactView) {\r\n            return item.hOffset\r\n        }\r\n        var align = options.horizontalAlignment;\r\n        var colWidth = exportItems.itemWidth;\r\n        var dx = colWidth - item.width;\r\n        return item.c * colWidth + (\"right\" === align ? dx : \"center\" === align ? dx / 2 : 0)\r\n    };\r\n    var totalHeight = exportItems.totalHeight;\r\n    var totalWidth = exportItems.totalWidth;\r\n    return {\r\n        markup: \"<svg \" + backgroundColor + 'height=\"' + totalHeight + '\" width=\"' + totalWidth + '\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\">' + exportItems.items.map(function(item) {\r\n            return '<g transform=\"translate('.concat(getHOffset(item), \",\").concat(getVOffset(item), ')\">').concat(item.markup, \"</g>\")\r\n        }).join(\"\") + \"</svg>\",\r\n        width: totalWidth,\r\n        height: totalHeight\r\n    }\r\n};\r\nexports.combineMarkups = combineMarkups;\r\nvar ExportMenu = function(params) {\r\n    var renderer = this._renderer = params.renderer;\r\n    this._incidentOccurred = params.incidentOccurred;\r\n    this._exportTo = params.exportTo;\r\n    this._print = params.print;\r\n    this._shadow = renderer.shadowFilter(\"-50%\", \"-50%\", \"200%\", \"200%\", SHADOW_OFFSET, 6, SHADOW_BLUR);\r\n    this._shadow.attr({\r\n        opacity: .8\r\n    });\r\n    this._group = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS,\r\n        \"hidden-for-export\": true\r\n    }).linkOn(renderer.root, {\r\n        name: \"export-menu\",\r\n        after: \"peripheral\"\r\n    });\r\n    this._buttonGroup = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-button\"\r\n    }).append(this._group);\r\n    this._listGroup = renderer.g().attr({\r\n        \"class\": EXPORT_CSS_CLASS + \"-list\"\r\n    }).append(this._group);\r\n    this._overlay = renderer.rect(-LIST_WIDTH + BUTTON_SIZE, BUTTON_SIZE + LIST_PADDING_TOP, LIST_WIDTH, 0);\r\n    this._overlay.attr({\r\n        \"stroke-width\": LIST_STROKE_WIDTH,\r\n        cursor: \"pointer\",\r\n        rx: 4,\r\n        ry: 4,\r\n        filter: this._shadow.id\r\n    });\r\n    this._overlay.data({\r\n        \"export-element-type\": \"list\"\r\n    });\r\n    this.validFormats = getValidFormats();\r\n    this._subscribeEvents()\r\n};\r\nexports.ExportMenu = ExportMenu;\r\n(0, _extend.extend)(ExportMenu.prototype, {\r\n    getLayoutOptions: function() {\r\n        if (this._hiddenDueToLayout) {\r\n            return {\r\n                width: 0,\r\n                height: 0,\r\n                cutSide: \"vertical\",\r\n                cutLayoutSide: \"top\"\r\n            }\r\n        }\r\n        var bBox = this._buttonGroup.getBBox();\r\n        bBox.cutSide = \"vertical\";\r\n        bBox.cutLayoutSide = \"top\";\r\n        bBox.height += MARGIN;\r\n        bBox.position = {\r\n            vertical: \"top\",\r\n            horizontal: \"right\"\r\n        };\r\n        bBox.verticalAlignment = \"top\";\r\n        bBox.horizontalAlignment = \"right\";\r\n        return bBox\r\n    },\r\n    shift: function(_, y) {\r\n        this._group.attr({\r\n            translateY: this._group.attr(\"translateY\") + y\r\n        })\r\n    },\r\n    draw: function(width, height, canvas) {\r\n        this._group.move(width - BUTTON_SIZE - SHADOW_OFFSET - SHADOW_BLUR + canvas.left, Math.floor(height / 2 - BUTTON_SIZE / 2));\r\n        var layoutOptions = this.getLayoutOptions();\r\n        if (layoutOptions.width > width || layoutOptions.height > height) {\r\n            this.freeSpace()\r\n        }\r\n        return this\r\n    },\r\n    show: function() {\r\n        this._group.linkAppend()\r\n    },\r\n    hide: function() {\r\n        this._group.linkRemove()\r\n    },\r\n    setOptions: function(options) {\r\n        var _this2 = this;\r\n        this._options = options;\r\n        if (options.formats) {\r\n            options.formats = options.formats.reduce(function(r, format) {\r\n                format = validateFormat(format, _this2._incidentOccurred, _this2.validFormats);\r\n                format && r.push(format);\r\n                return r\r\n            }, [])\r\n        } else {\r\n            options.formats = this.validFormats.supported.slice()\r\n        }\r\n        options.printingEnabled = void 0 === options.printingEnabled ? true : options.printingEnabled;\r\n        if (options.enabled && (options.formats.length || options.printingEnabled)) {\r\n            this.show();\r\n            this._updateButton();\r\n            this._updateList();\r\n            this._hideList()\r\n        } else {\r\n            this.hide()\r\n        }\r\n    },\r\n    dispose: function() {\r\n        this._unsubscribeEvents();\r\n        this._group.linkRemove().linkOff();\r\n        this._group.dispose();\r\n        this._shadow.dispose()\r\n    },\r\n    layoutOptions: function() {\r\n        return this._options.enabled && {\r\n            horizontalAlignment: \"right\",\r\n            verticalAlignment: \"top\",\r\n            weak: true\r\n        }\r\n    },\r\n    measure: function() {\r\n        this._fillSpace();\r\n        var margin = this._options.button.margin;\r\n        return [BUTTON_SIZE + margin.left + margin.right, BUTTON_SIZE + margin.top + margin.bottom]\r\n    },\r\n    move: function(rect) {\r\n        var margin = this._options.button.margin;\r\n        this._group.attr({\r\n            translateX: Math.round(rect[0]) + margin.left,\r\n            translateY: Math.round(rect[1]) + margin.top\r\n        })\r\n    },\r\n    _fillSpace: function() {\r\n        this._hiddenDueToLayout = false;\r\n        this.show()\r\n    },\r\n    freeSpace: function() {\r\n        this._incidentOccurred(\"W2107\");\r\n        this._hiddenDueToLayout = true;\r\n        this.hide()\r\n    },\r\n    _hideList: function() {\r\n        this._listGroup.remove();\r\n        this._listShown = false;\r\n        this._setButtonState(\"default\");\r\n        this._menuItems.forEach(function(item) {\r\n            return item.resetState()\r\n        })\r\n    },\r\n    _showList: function() {\r\n        this._listGroup.append(this._group);\r\n        this._listShown = true;\r\n        this._menuItems.forEach(function(item) {\r\n            return item.fixPosition()\r\n        })\r\n    },\r\n    _setButtonState: function(state) {\r\n        var style = this._options.button[state];\r\n        this._button.attr({\r\n            stroke: style.borderColor,\r\n            fill: style.backgroundColor\r\n        });\r\n        this._icon.attr({\r\n            fill: style.color\r\n        })\r\n    },\r\n    _subscribeEvents: function() {\r\n        var _this3 = this;\r\n        this._renderer.root.on(_pointer.default.up + \".export\", function(e) {\r\n            var elementType = e.target[EXPORT_DATA_KEY];\r\n            if (!elementType) {\r\n                if (_this3._button) {\r\n                    _this3._hideList()\r\n                }\r\n                return\r\n            }\r\n            if (\"button\" === elementType) {\r\n                if (_this3._listShown) {\r\n                    _this3._setButtonState(\"default\");\r\n                    _this3._hideList()\r\n                } else {\r\n                    _this3._setButtonState(\"focus\");\r\n                    _this3._showList()\r\n                }\r\n            } else {\r\n                if (\"printing\" === elementType) {\r\n                    _this3._print();\r\n                    _this3._hideList()\r\n                } else {\r\n                    if (\"exporting\" === elementType) {\r\n                        _this3._exportTo(e.target[FORMAT_DATA_KEY]);\r\n                        _this3._hideList()\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        this._listGroup.on(pointerActions, function(e) {\r\n            return e.stopPropagation()\r\n        });\r\n        this._buttonGroup.on(_pointer.default.enter, function() {\r\n            return _this3._setButtonState(\"hover\")\r\n        });\r\n        this._buttonGroup.on(_pointer.default.leave, function() {\r\n            return _this3._setButtonState(_this3._listShown ? \"focus\" : \"default\")\r\n        });\r\n        this._buttonGroup.on(_pointer.default.down + \".export\", function() {\r\n            return _this3._setButtonState(\"active\")\r\n        })\r\n    },\r\n    _unsubscribeEvents: function() {\r\n        this._renderer.root.off(\".export\");\r\n        this._listGroup.off();\r\n        this._buttonGroup.off()\r\n    },\r\n    _updateButton: function() {\r\n        var renderer = this._renderer;\r\n        var options = this._options;\r\n        var exportData = {\r\n            \"export-element-type\": \"button\"\r\n        };\r\n        if (!this._button) {\r\n            this._button = renderer.rect(0, 0, BUTTON_SIZE, BUTTON_SIZE).append(this._buttonGroup);\r\n            this._button.attr({\r\n                rx: 4,\r\n                ry: 4,\r\n                fill: options.button.default.backgroundColor,\r\n                stroke: options.button.default.borderColor,\r\n                \"stroke-width\": 1,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._button.data(exportData);\r\n            this._icon = renderer.path(ICON_COORDS).append(this._buttonGroup);\r\n            this._icon.attr({\r\n                fill: options.button.default.color,\r\n                cursor: \"pointer\"\r\n            });\r\n            this._icon.data(exportData);\r\n            this._buttonGroup.setTitle(_message.default.format(\"vizExport-titleMenuText\"))\r\n        }\r\n    },\r\n    _updateList: function() {\r\n        var options = this._options;\r\n        var buttonDefault = options.button.default;\r\n        var listGroup = this._listGroup;\r\n        var items = createMenuItems(this._renderer, options);\r\n        this._shadow.attr({\r\n            color: options.shadowColor\r\n        });\r\n        this._overlay.attr({\r\n            height: items.length * MENU_ITEM_HEIGHT + 2 * LIST_STROKE_WIDTH,\r\n            fill: buttonDefault.backgroundColor,\r\n            stroke: buttonDefault.borderColor\r\n        });\r\n        listGroup.clear();\r\n        this._overlay.append(listGroup);\r\n        items.forEach(function(item) {\r\n            return item.g.append(listGroup)\r\n        });\r\n        this._menuItems = items\r\n    }\r\n});\r\n\r\nfunction getExportOptions(widget, exportOptions, fileName, format) {\r\n    if (format || exportOptions.format) {\r\n        format = validateFormat(format || exportOptions.format, widget._incidentOccurred)\r\n    }\r\n    return {\r\n        format: format || DEFAULT_EXPORT_FORMAT,\r\n        fileName: fileName || exportOptions.fileName || \"file\",\r\n        proxyUrl: exportOptions.proxyUrl,\r\n        backgroundColor: exportOptions.backgroundColor,\r\n        width: widget._canvas.width,\r\n        height: widget._canvas.height,\r\n        margin: exportOptions.margin,\r\n        svgToCanvas: exportOptions.svgToCanvas,\r\n        forceProxy: exportOptions.forceProxy,\r\n        exportingAction: widget._createActionByOption(\"onExporting\"),\r\n        exportedAction: widget._createActionByOption(\"onExported\"),\r\n        fileSavingAction: widget._createActionByOption(\"onFileSaving\")\r\n    }\r\n}\r\nvar plugin = {\r\n    name: \"export\",\r\n    init: function() {\r\n        var _this4 = this;\r\n        this._exportMenu = new ExportMenu({\r\n            renderer: this._renderer,\r\n            incidentOccurred: this._incidentOccurred,\r\n            print: function() {\r\n                return _this4.print()\r\n            },\r\n            exportTo: function(format) {\r\n                return _this4.exportTo(void 0, format)\r\n            }\r\n        });\r\n        this._layout.add(this._exportMenu)\r\n    },\r\n    dispose: function() {\r\n        this._exportMenu.dispose()\r\n    },\r\n    members: {\r\n        _getExportMenuOptions: function() {\r\n            return (0, _extend.extend)({}, this._getOption(\"export\"), {\r\n                rtl: this._getOption(\"rtlEnabled\", true)\r\n            })\r\n        },\r\n        _disablePointerEvents: function() {\r\n            var pointerEventsValue = this._renderer.root.attr(\"pointer-events\");\r\n            this._renderer.root.attr({\r\n                \"pointer-events\": \"none\"\r\n            });\r\n            return pointerEventsValue\r\n        },\r\n        exportTo: function(fileName, format) {\r\n            var _this5 = this;\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {}, fileName, format);\r\n            menu && menu.hide();\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            var promise = (0, _exporter.export)(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function() {\r\n                _this5._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        },\r\n        print: function() {\r\n            var _this6 = this;\r\n            var menu = this._exportMenu;\r\n            var options = getExportOptions(this, this._getOption(\"export\") || {});\r\n            options.exportingAction = null;\r\n            options.exportedAction = null;\r\n            options.margin = 0;\r\n            options.format = \"PNG\";\r\n            options.forceProxy = true;\r\n            options.fileSavingAction = function(eventArgs) {\r\n                _print(\"data:image/png;base64,\".concat(eventArgs.data), {\r\n                    __test: options.__test\r\n                });\r\n                eventArgs.cancel = true\r\n            };\r\n            var pointerEventsValue = this._disablePointerEvents();\r\n            menu && menu.hide();\r\n            var promise = (0, _exporter.export)(this._renderer.root.element, options, getCreatorFunc(options.format)).fail(_console.logger.error).always(function() {\r\n                _this6._renderer.root.attr({\r\n                    \"pointer-events\": pointerEventsValue\r\n                })\r\n            });\r\n            menu && menu.show();\r\n            return promise\r\n        }\r\n    },\r\n    customize: function(constructor) {\r\n        var proto = constructor.prototype;\r\n        constructor.addChange({\r\n            code: \"EXPORT\",\r\n            handler: function() {\r\n                this._exportMenu.setOptions(this._getExportMenuOptions());\r\n                this._change([\"LAYOUT\"])\r\n            },\r\n            isThemeDependent: true,\r\n            isOptionChange: true,\r\n            option: \"export\"\r\n        });\r\n        proto._optionChangesMap.onExporting = \"EXPORT\";\r\n        proto._optionChangesMap.onExported = \"EXPORT\";\r\n        proto._optionChangesMap.onFileSaving = \"EXPORT\"\r\n    },\r\n    fontFields: [\"export.font\"]\r\n};\r\nexports.plugin = plugin;\r\n"]},"metadata":{},"sourceType":"script"}