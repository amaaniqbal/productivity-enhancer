{"ast":null,"code":"var _toConsumableArray = require(\"E:\\\\Monday.com\\\\quickstart-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/toConsumableArray\");\n\nvar _classCallCheck = require(\"E:\\\\Monday.com\\\\quickstart-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"E:\\\\Monday.com\\\\quickstart-react\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/createClass\");\n\nvar mondayApiClient = require(\"./monday-api-client\");\n\nvar _require = require(\"./constants.js\"),\n    MONDAY_OAUTH_URL = _require.MONDAY_OAUTH_URL;\n\nvar _require2 = require(\"./helpers\"),\n    convertToArrayIfNeeded = _require2.convertToArrayIfNeeded;\n\nvar _require3 = require(\"./helpers/ui-helpers\"),\n    initScrollHelperIfNeeded = _require3.initScrollHelperIfNeeded;\n\nvar _require4 = require(\"./services/background-tracking-service\"),\n    initBackgroundTracking = _require4.initBackgroundTracking;\n\nvar EMPTY_ARRAY = [];\n\nvar MondayClientSdk = /*#__PURE__*/function () {\n  \"use strict\";\n\n  function MondayClientSdk() {\n    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    _classCallCheck(this, MondayClientSdk);\n\n    this._clientId = options.clientId;\n    this._apiToken = options.apiToken;\n    this.listeners = {};\n    this.setClientId = this.setClientId.bind(this);\n    this.setToken = this.setToken.bind(this);\n    this.api = this.api.bind(this);\n    this.listen = this.listen.bind(this);\n    this.get = this.get.bind(this);\n    this.execute = this.execute.bind(this);\n    this.oauth = this.oauth.bind(this);\n    this._receiveMessage = this._receiveMessage.bind(this);\n    this.storage = {\n      instance: {\n        setItem: this.setStorageInstanceItem.bind(this),\n        getItem: this.getStorageInstanceItem.bind(this),\n        deleteItem: this.deleteStorageInstanceItem.bind(this)\n      }\n    };\n    window.addEventListener(\"message\", this._receiveMessage, false);\n    if (!options.withoutScrollHelper) initScrollHelperIfNeeded();\n    initBackgroundTracking(this);\n  }\n\n  _createClass(MondayClientSdk, [{\n    key: \"setClientId\",\n    value: function setClientId(clientId) {\n      this._clientId = clientId;\n    }\n  }, {\n    key: \"setToken\",\n    value: function setToken(token) {\n      this._apiToken = token;\n    }\n  }, {\n    key: \"api\",\n    value: function api(query) {\n      var _this = this;\n\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var params = {\n        query: query,\n        variables: options.variables\n      };\n      var token = options.token || this._apiToken;\n\n      if (token) {\n        return mondayApiClient.execute(params, token);\n      } else {\n        return new Promise(function (resolve, reject) {\n          _this._localApi(\"api\", {\n            params: params\n          }).then(function (result) {\n            resolve(result.data);\n          }).catch(function (err) {\n            return reject(err);\n          });\n        });\n      }\n    }\n  }, {\n    key: \"listen\",\n    value: function listen(typeOrTypes, callback, params) {\n      var _this2 = this;\n\n      var types = convertToArrayIfNeeded(typeOrTypes);\n      types.forEach(function (type) {\n        _this2._addListener(type, callback);\n\n        _this2._localApi(\"listen\", {\n          type: type,\n          params: params\n        });\n      }); // todo uniq listeners, remove listener\n    }\n  }, {\n    key: \"get\",\n    value: function get(type, params) {\n      return this._localApi(\"get\", {\n        type: type,\n        params: params\n      });\n    }\n  }, {\n    key: \"execute\",\n    value: function execute(type, params) {\n      return this._localApi(\"execute\", {\n        type: type,\n        params: params\n      });\n    }\n  }, {\n    key: \"track\",\n    value: function track(name, data) {\n      return this.execute(\"track\", {\n        name: name,\n        data: data\n      });\n    }\n  }, {\n    key: \"oauth\",\n    value: function oauth() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var clientId = options.clientId || this._clientId;\n      if (!clientId) throw new Error(\"clientId is required\");\n      var mondayOauthUrl = options.mondayOauthUrl || MONDAY_OAUTH_URL;\n      var url = \"\".concat(mondayOauthUrl, \"?client_id=\").concat(clientId);\n      window.location = url;\n    }\n  }, {\n    key: \"setStorageInstanceItem\",\n    value: function setStorageInstanceItem(key, value) {\n      var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      return this._localApi(\"storage\", {\n        method: \"set\",\n        key: key,\n        value: value,\n        options: options,\n        segment: \"instance\"\n      });\n    }\n  }, {\n    key: \"getStorageInstanceItem\",\n    value: function getStorageInstanceItem(key) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this._localApi(\"storage\", {\n        method: \"get\",\n        key: key,\n        options: options,\n        segment: \"instance\"\n      });\n    }\n  }, {\n    key: \"deleteStorageInstanceItem\",\n    value: function deleteStorageInstanceItem(key) {\n      var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return this._localApi(\"storage\", {\n        method: \"delete\",\n        key: key,\n        options: options,\n        segment: \"instance\"\n      });\n    }\n  }, {\n    key: \"_localApi\",\n    value: function _localApi(method, args) {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        var requestId = _this3._generateRequestId();\n\n        var clientId = _this3._clientId;\n\n        var pjson = require(\"../package.json\");\n\n        var version = pjson.version;\n        window.parent.postMessage({\n          method: method,\n          args: args,\n          requestId: requestId,\n          clientId: clientId,\n          version: version\n        }, \"*\");\n\n        _this3._addListener(requestId, function (data) {\n          if (data.errorMessage) {\n            reject(new Error(data.errorMessage));\n          } else {\n            resolve(data);\n          }\n        });\n      });\n    }\n  }, {\n    key: \"_receiveMessage\",\n    value: function _receiveMessage(event) {\n      var _event$data = event.data,\n          method = _event$data.method,\n          type = _event$data.type,\n          requestId = _event$data.requestId;\n      var methodListeners = this.listeners[method] || EMPTY_ARRAY;\n      var typeListeners = this.listeners[type] || EMPTY_ARRAY;\n      var requestIdListeners = this.listeners[requestId] || EMPTY_ARRAY;\n      var listeners = [].concat(_toConsumableArray(methodListeners), _toConsumableArray(typeListeners), _toConsumableArray(requestIdListeners));\n\n      if (listeners) {\n        listeners.forEach(function (listener) {\n          try {\n            listener(event.data);\n          } catch (err) {\n            console.error(\"Message callback error: \", err);\n          }\n        });\n      }\n    }\n  }, {\n    key: \"_addListener\",\n    value: function _addListener(key, callback) {\n      this.listeners[key] = this.listeners[key] || [];\n      this.listeners[key].push(callback);\n    }\n  }, {\n    key: \"_generateRequestId\",\n    value: function _generateRequestId() {\n      return Math.random().toString(36).substr(2, 9);\n    }\n  }, {\n    key: \"_removeEventListener\",\n    value: function _removeEventListener() {\n      window.removeEventListener(\"message\", this._receiveMessage, false);\n    }\n  }, {\n    key: \"_clearListeners\",\n    value: function _clearListeners() {\n      this.listeners = [];\n    }\n  }]);\n\n  return MondayClientSdk;\n}();\n\nfunction init() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return new MondayClientSdk(options);\n}\n\nmodule.exports = init;","map":{"version":3,"sources":["E:/Monday.com/quickstart-react/node_modules/monday-sdk-js/src/client.js"],"names":["mondayApiClient","require","MONDAY_OAUTH_URL","convertToArrayIfNeeded","initScrollHelperIfNeeded","initBackgroundTracking","EMPTY_ARRAY","MondayClientSdk","options","_clientId","clientId","_apiToken","apiToken","listeners","setClientId","bind","setToken","api","listen","get","execute","oauth","_receiveMessage","storage","instance","setItem","setStorageInstanceItem","getItem","getStorageInstanceItem","deleteItem","deleteStorageInstanceItem","window","addEventListener","withoutScrollHelper","token","query","params","variables","Promise","resolve","reject","_localApi","then","result","data","catch","err","typeOrTypes","callback","types","forEach","type","_addListener","name","Error","mondayOauthUrl","url","location","key","value","method","segment","args","requestId","_generateRequestId","pjson","version","parent","postMessage","errorMessage","event","methodListeners","typeListeners","requestIdListeners","listener","console","error","push","Math","random","toString","substr","removeEventListener","init","module","exports"],"mappings":"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","sourcesContent":["const mondayApiClient = require(\"./monday-api-client\");\nconst { MONDAY_OAUTH_URL } = require(\"./constants.js\");\nconst { convertToArrayIfNeeded } = require(\"./helpers\");\nconst { initScrollHelperIfNeeded } = require(\"./helpers/ui-helpers\");\nconst { initBackgroundTracking } = require(\"./services/background-tracking-service\");\n\nconst EMPTY_ARRAY = [];\n\nclass MondayClientSdk {\n  constructor(options = {}) {\n    this._clientId = options.clientId;\n    this._apiToken = options.apiToken;\n\n    this.listeners = {};\n\n    this.setClientId = this.setClientId.bind(this);\n    this.setToken = this.setToken.bind(this);\n    this.api = this.api.bind(this);\n    this.listen = this.listen.bind(this);\n    this.get = this.get.bind(this);\n    this.execute = this.execute.bind(this);\n    this.oauth = this.oauth.bind(this);\n    this._receiveMessage = this._receiveMessage.bind(this);\n\n    this.storage = {\n      instance: {\n        setItem: this.setStorageInstanceItem.bind(this),\n        getItem: this.getStorageInstanceItem.bind(this),\n        deleteItem: this.deleteStorageInstanceItem.bind(this)\n      }\n    };\n\n    window.addEventListener(\"message\", this._receiveMessage, false);\n\n    if (!options.withoutScrollHelper) initScrollHelperIfNeeded();\n\n    initBackgroundTracking(this);\n  }\n\n  setClientId(clientId) {\n    this._clientId = clientId;\n  }\n\n  setToken(token) {\n    this._apiToken = token;\n  }\n\n  api(query, options = {}) {\n    const params = { query, variables: options.variables };\n    const token = options.token || this._apiToken;\n    if (token) {\n      return mondayApiClient.execute(params, token);\n    } else {\n      return new Promise((resolve, reject) => {\n        this._localApi(\"api\", { params })\n          .then(result => {\n            resolve(result.data);\n          })\n          .catch(err => reject(err));\n      });\n    }\n  }\n\n  listen(typeOrTypes, callback, params) {\n    const types = convertToArrayIfNeeded(typeOrTypes);\n    types.forEach(type => {\n      this._addListener(type, callback);\n      this._localApi(\"listen\", { type, params });\n    });\n    // todo uniq listeners, remove listener\n  }\n\n  get(type, params) {\n    return this._localApi(\"get\", { type, params });\n  }\n\n  execute(type, params) {\n    return this._localApi(\"execute\", { type, params });\n  }\n\n  track(name, data) {\n    return this.execute(\"track\", { name, data });\n  }\n\n  oauth(options = {}) {\n    const clientId = options.clientId || this._clientId;\n    if (!clientId) throw new Error(\"clientId is required\");\n\n    const mondayOauthUrl = options.mondayOauthUrl || MONDAY_OAUTH_URL;\n\n    const url = `${mondayOauthUrl}?client_id=${clientId}`;\n    window.location = url;\n  }\n\n  setStorageInstanceItem(key, value, options = {}) {\n    return this._localApi(\"storage\", { method: \"set\", key, value, options, segment: \"instance\" });\n  }\n\n  getStorageInstanceItem(key, options = {}) {\n    return this._localApi(\"storage\", { method: \"get\", key, options, segment: \"instance\" });\n  }\n\n  deleteStorageInstanceItem(key, options = {}) {\n    return this._localApi(\"storage\", { method: \"delete\", key, options, segment: \"instance\" });\n  }\n\n  _localApi(method, args) {\n    return new Promise((resolve, reject) => {\n      const requestId = this._generateRequestId();\n      const clientId = this._clientId;\n      const pjson = require(\"../package.json\");\n      const version = pjson.version;\n\n      window.parent.postMessage({ method, args, requestId, clientId, version }, \"*\");\n      this._addListener(requestId, data => {\n        if (data.errorMessage) {\n          reject(new Error(data.errorMessage));\n        } else {\n          resolve(data);\n        }\n      });\n    });\n  }\n\n  _receiveMessage(event) {\n    const { method, type, requestId } = event.data;\n    const methodListeners = this.listeners[method] || EMPTY_ARRAY;\n    const typeListeners = this.listeners[type] || EMPTY_ARRAY;\n    const requestIdListeners = this.listeners[requestId] || EMPTY_ARRAY;\n    let listeners = [...methodListeners, ...typeListeners, ...requestIdListeners];\n\n    if (listeners) {\n      listeners.forEach(listener => {\n        try {\n          listener(event.data);\n        } catch (err) {\n          console.error(\"Message callback error: \", err);\n        }\n      });\n    }\n  }\n\n  _addListener(key, callback) {\n    this.listeners[key] = this.listeners[key] || [];\n    this.listeners[key].push(callback);\n  }\n\n  _generateRequestId() {\n    return Math.random()\n      .toString(36)\n      .substr(2, 9);\n  }\n\n  _removeEventListener() {\n    window.removeEventListener(\"message\", this._receiveMessage, false);\n  }\n  _clearListeners() {\n    this.listeners = [];\n  }\n}\n\nfunction init(options = {}) {\n  return new MondayClientSdk(options);\n}\n\nmodule.exports = init;\n"]},"metadata":{},"sourceType":"script"}