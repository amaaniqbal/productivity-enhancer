{"ast":null,"code":"/**\r\n * DevExtreme (viz/series/points/label.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.Label = Label;\n\nvar _format_helper = _interopRequireDefault(require(\"../../../format_helper\"));\n\nvar _utils = require(\"../../core/utils\");\n\nvar _iterator = require(\"../../../core/utils/iterator\");\n\nvar _extend = require(\"../../../core/utils/extend\");\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nvar _format = _format_helper.default.format;\nvar _math = Math;\nvar _round = _math.round;\nvar _floor = _math.floor;\nvar _abs = _math.abs;\nvar CONNECTOR_LENGTH = 12;\nvar LABEL_BACKGROUND_PADDING_X = 8;\nvar LABEL_BACKGROUND_PADDING_Y = 4;\n\nfunction getClosestCoord(point, coords) {\n  var closestDistance = 1 / 0;\n  var closestCoord;\n  (0, _iterator.each)(coords, function (_, coord) {\n    var x = point[0] - coord[0];\n    var y = point[1] - coord[1];\n    var distance = x * x + y * y;\n\n    if (distance < closestDistance) {\n      closestDistance = distance;\n      closestCoord = coord;\n    }\n  });\n  return [_floor(closestCoord[0]), _floor(closestCoord[1])];\n}\n\nfunction getCrossCoord(rect, coord, indexOffset) {\n  return (coord - rect[0 + indexOffset]) / (rect[2 + indexOffset] - rect[0 + indexOffset]) * (rect[3 - indexOffset] - rect[1 - indexOffset]) + rect[1 - indexOffset];\n}\n\nvar barPointStrategy = {\n  isLabelInside: function (labelPoint, figure) {\n    var xc = labelPoint.x + labelPoint.width / 2;\n    var yc = labelPoint.y + labelPoint.height / 2;\n    return figure.x <= xc && xc <= figure.x + figure.width && figure.y <= yc && yc <= figure.y + figure.height;\n  },\n  prepareLabelPoints: function (bBox, rotatedBBox, isHorizontal, angle, figureCenter) {\n    var x1 = rotatedBBox.x;\n    var xc = x1 + rotatedBBox.width / 2;\n    var x2 = x1 + rotatedBBox.width - 1;\n    var y1 = rotatedBBox.y;\n    var yc = y1 + rotatedBBox.height / 2;\n    var y2 = y1 + rotatedBBox.height - 1;\n    var labelPoints;\n    var isRectangular = _abs(angle) % 90 === 0;\n\n    if (figureCenter[0] > x1 && figureCenter[0] < x2) {\n      if (isRectangular) {\n        labelPoints = [[figureCenter[0], _abs(figureCenter[1] - y1) < _abs(figureCenter[1] - y2) ? y1 : y2]];\n      } else {\n        labelPoints = [[figureCenter[0], getCrossCoord([x1, y1, x2, y2], figureCenter[0], 0)]];\n      }\n    } else {\n      if (figureCenter[1] > y1 && figureCenter[1] < y2) {\n        if (isRectangular) {\n          labelPoints = [[_abs(figureCenter[0] - x1) < _abs(figureCenter[0] - x2) ? x1 : x2, figureCenter[1]]];\n        } else {\n          labelPoints = [[getCrossCoord([x1, y1, x2, y2], figureCenter[1], 1), figureCenter[1]]];\n        }\n      } else {\n        if (isRectangular) {\n          labelPoints = [[x1, y1], [isHorizontal ? x1 : xc, isHorizontal ? yc : y1], [x2, y1], [x1, y2], [isHorizontal ? x2 : xc, isHorizontal ? yc : y2], [x2, y2]];\n        } else {\n          labelPoints = [[xc, yc]];\n        }\n      }\n    }\n\n    return labelPoints;\n  },\n  isHorizontal: function (bBox, figure) {\n    return bBox.x > figure.x + figure.width || bBox.x + bBox.width < figure.x;\n  },\n  getFigureCenter: function (figure) {\n    return [_floor(figure.x + figure.width / 2), _floor(figure.y + figure.height / 2)];\n  },\n  findFigurePoint: function (figure, labelPoint) {\n    var figureCenter = barPointStrategy.getFigureCenter(figure);\n    var point = getClosestCoord(labelPoint, [[figure.x, figureCenter[1]], [figureCenter[0], figure.y + figure.height], [figure.x + figure.width, figureCenter[1]], [figureCenter[0], figure.y]]);\n    return point;\n  },\n  adjustPoints: function (points) {\n    var lineIsVertical = _abs(points[1] - points[3]) <= 1;\n    var lineIsHorizontal = _abs(points[0] - points[2]) <= 1;\n\n    if (lineIsHorizontal) {\n      points[0] = points[2];\n    }\n\n    if (lineIsVertical) {\n      points[1] = points[3];\n    }\n\n    return points;\n  }\n};\nvar symbolPointStrategy = {\n  isLabelInside: function () {\n    return false;\n  },\n  prepareLabelPoints: barPointStrategy.prepareLabelPoints,\n  isHorizontal: function (bBox, figure) {\n    return bBox.x > figure.x + figure.r || bBox.x + bBox.width < figure.x - figure.r;\n  },\n  getFigureCenter: function (figure) {\n    return [figure.x, figure.y];\n  },\n  findFigurePoint: function (figure, labelPoint) {\n    var angle = Math.atan2(figure.y - labelPoint[1], labelPoint[0] - figure.x);\n    return [_round(figure.x + figure.r * Math.cos(angle)), _round(figure.y - figure.r * Math.sin(angle))];\n  },\n  adjustPoints: barPointStrategy.adjustPoints\n};\nvar piePointStrategy = {\n  isLabelInside: function (_0, _1, isOutside) {\n    return !isOutside;\n  },\n  prepareLabelPoints: function (bBox, rotatedBBox, isHorizontal, angle) {\n    var xl = bBox.x;\n    var xr = xl + bBox.width;\n\n    var xc = xl + _round(bBox.width / 2);\n\n    var yt = bBox.y;\n    var yb = yt + bBox.height;\n\n    var yc = yt + _round(bBox.height / 2);\n\n    var points = [[[xl, yt], [xr, yt]], [[xr, yt], [xr, yb]], [[xr, yb], [xl, yb]], [[xl, yb], [xl, yt]]];\n    var cosSin = (0, _utils.getCosAndSin)(angle);\n\n    if (0 === angle) {\n      points = isHorizontal ? [[xl, yc], [xr, yc]] : [[xc, yt], [xc, yb]];\n    } else {\n      points = points.map(function (pair) {\n        return pair.map(function (point) {\n          return [_round((point[0] - xc) * cosSin.cos + (point[1] - yc) * cosSin.sin + xc), _round(-(point[0] - xc) * cosSin.sin + (point[1] - yc) * cosSin.cos + yc)];\n        });\n      }).reduce(function (r, pair) {\n        var point1x = pair[0][0];\n        var point1y = pair[0][1];\n        var point2x = pair[1][0];\n        var point2y = pair[1][1];\n\n        if (isHorizontal) {\n          if (point1y >= yc && yc >= point2y || point1y <= yc && yc <= point2y) {\n            r.push([(yc - point1y) * (point2x - point1x) / (point2y - point1y) + point1x, yc]);\n          }\n        } else {\n          if (point1x >= xc && xc >= point2x || point1x <= xc && xc <= point2x) {\n            r.push([xc, (xc - point1x) * (point2y - point1y) / (point2x - point1x) + point1y]);\n          }\n        }\n\n        return r;\n      }, []);\n    }\n\n    return points;\n  },\n  isHorizontal: function (bBox, figure) {\n    return bBox.x > figure.x || figure.x > bBox.x + bBox.width;\n  },\n  getFigureCenter: symbolPointStrategy.getFigureCenter,\n  findFigurePoint: function (figure, labelPoint, isHorizontal) {\n    if (!isHorizontal) {\n      return [figure.x, figure.y];\n    }\n\n    var labelX = labelPoint[0];\n\n    var x = _round(figure.x + (figure.y - labelPoint[1]) / Math.tan((0, _utils.degreesToRadians)(figure.angle)));\n\n    var points = [figure.x, figure.y, x, labelPoint[1]];\n\n    if (!(figure.x <= x && x <= labelX) && !(labelX <= x && x <= figure.x)) {\n      if (_abs(figure.x - labelX) < CONNECTOR_LENGTH) {\n        points = [figure.x, figure.y];\n      } else {\n        if (figure.x <= labelX) {\n          points[2] = figure.x + CONNECTOR_LENGTH;\n        } else {\n          points[2] = figure.x - CONNECTOR_LENGTH;\n        }\n      }\n    }\n\n    return points;\n  },\n  adjustPoints: function (points) {\n    return points;\n  }\n};\n\nfunction selectStrategy(figure) {\n  return void 0 !== figure.angle && piePointStrategy || void 0 !== figure.r && symbolPointStrategy || barPointStrategy;\n}\n\nfunction disposeItem(obj, field) {\n  obj[field] && obj[field].dispose();\n  obj[field] = null;\n}\n\nfunction checkBackground(background) {\n  return background && (background.fill && \"none\" !== background.fill || background[\"stroke-width\"] > 0 && background.stroke && \"none\" !== background.stroke);\n}\n\nfunction checkConnector(connector) {\n  return connector && connector[\"stroke-width\"] > 0 && connector.stroke && \"none\" !== connector.stroke;\n}\n\nfunction formatText(data, options) {\n  var format = options.format;\n  data.valueText = _format(data.value, format);\n  data.argumentText = _format(data.argument, options.argumentFormat);\n\n  if (void 0 !== data.percent) {\n    data.percentText = _format(data.percent, {\n      type: \"percent\",\n      precision: format && format.percentPrecision\n    });\n  }\n\n  if (void 0 !== data.total) {\n    data.totalText = _format(data.total, format);\n  }\n\n  if (void 0 !== data.openValue) {\n    data.openValueText = _format(data.openValue, format);\n  }\n\n  if (void 0 !== data.closeValue) {\n    data.closeValueText = _format(data.closeValue, format);\n  }\n\n  if (void 0 !== data.lowValue) {\n    data.lowValueText = _format(data.lowValue, format);\n  }\n\n  if (void 0 !== data.highValue) {\n    data.highValueText = _format(data.highValue, format);\n  }\n\n  if (void 0 !== data.reductionValue) {\n    data.reductionValueText = _format(data.reductionValue, format);\n  }\n\n  return options.customizeText ? options.customizeText.call(data, data) : data.valueText;\n}\n\nfunction Label(renderSettings) {\n  this._renderer = renderSettings.renderer;\n  this._container = renderSettings.labelsGroup;\n  this._point = renderSettings.point;\n  this._strategy = renderSettings.strategy;\n  this._rowCount = 1;\n}\n\nLabel.prototype = {\n  constructor: Label,\n  setColor: function (color) {\n    this._color = color;\n  },\n  setOptions: function (options) {\n    this._options = options;\n  },\n  setData: function (data) {\n    this._data = data;\n  },\n  setDataField: function (fieldName, fieldValue) {\n    this._data = this._data || {};\n    this._data[fieldName] = fieldValue;\n  },\n  getData: function () {\n    return this._data;\n  },\n  setFigureToDrawConnector: function (figure) {\n    this._figure = figure;\n  },\n  dispose: function () {\n    var that = this;\n    disposeItem(that, \"_group\");\n    that._data = that._options = that._textContent = that._visible = that._insideGroup = that._text = that._background = that._connector = that._figure = null;\n  },\n  _setVisibility: function (value, state) {\n    this._group && this._group.attr({\n      visibility: value\n    });\n    this._visible = state;\n  },\n  isVisible: function () {\n    return this._visible;\n  },\n  hide: function (holdInvisible) {\n    this._holdVisibility = !!holdInvisible;\n\n    this._hide();\n  },\n  _hide: function () {\n    this._setVisibility(\"hidden\", false);\n  },\n  show: function (holdVisible) {\n    var correctPosition = !this._drawn;\n\n    if (this._point.hasValue()) {\n      this._holdVisibility = !!holdVisible;\n\n      this._show();\n\n      correctPosition && this._point.correctLabelPosition(this);\n    }\n  },\n  _show: function () {\n    var that = this;\n    var renderer = that._renderer;\n    var container = that._container;\n    var options = that._options || {};\n    var text = that._textContent = formatText(that._data, that._options) || null;\n\n    if (text) {\n      if (!that._group) {\n        that._group = renderer.g().append(container);\n        that._insideGroup = renderer.g().append(that._group);\n        that._text = renderer.text(\"\", 0, 0).append(that._insideGroup);\n      }\n\n      that._text.css(options.attributes ? (0, _utils.patchFontOptions)(options.attributes.font) : {});\n\n      if (checkBackground(options.background)) {\n        that._background = that._background || renderer.rect().append(that._insideGroup).toBackground();\n\n        that._background.attr(options.background);\n\n        that._color && that._background.attr({\n          fill: that._color\n        });\n      } else {\n        disposeItem(that, \"_background\");\n      }\n\n      if (checkConnector(options.connector)) {\n        that._connector = that._connector || renderer.path([], \"line\").sharp().append(that._group).toBackground();\n\n        that._connector.attr(options.connector);\n\n        that._color && that._connector.attr({\n          stroke: that._color\n        });\n      } else {\n        disposeItem(that, \"_connector\");\n      }\n\n      that._text.attr({\n        text: text,\n        align: options.textAlignment,\n        \"class\": options.cssClass\n      });\n\n      that._updateBackground(that._text.getBBox());\n\n      that._setVisibility(\"visible\", true);\n\n      that._drawn = true;\n    } else {\n      that._hide();\n    }\n  },\n  _getLabelVisibility: function (isVisible) {\n    return this._holdVisibility ? this.isVisible() : isVisible;\n  },\n  draw: function (isVisible) {\n    if (this._getLabelVisibility(isVisible)) {\n      this._show();\n\n      this._point && this._point.correctLabelPosition(this);\n    } else {\n      this._drawn = false;\n\n      this._hide();\n    }\n\n    return this;\n  },\n  _updateBackground: function (bBox) {\n    var that = this;\n\n    if (that._background) {\n      bBox.x -= LABEL_BACKGROUND_PADDING_X;\n      bBox.y -= LABEL_BACKGROUND_PADDING_Y;\n      bBox.width += 2 * LABEL_BACKGROUND_PADDING_X;\n      bBox.height += 2 * LABEL_BACKGROUND_PADDING_Y;\n\n      that._background.attr(bBox);\n    }\n\n    that._bBoxWithoutRotation = (0, _extend.extend)({}, bBox);\n    var rotationAngle = that._options.rotationAngle || 0;\n\n    that._insideGroup.rotate(rotationAngle, bBox.x + bBox.width / 2, bBox.y + bBox.height / 2);\n\n    bBox = (0, _utils.rotateBBox)(bBox, [bBox.x + bBox.width / 2, bBox.y + bBox.height / 2], -rotationAngle);\n    that._bBox = bBox;\n  },\n  getFigureCenter: function () {\n    var figure = this._figure;\n    var strategy = this._strategy || selectStrategy(figure);\n    return strategy.getFigureCenter(figure);\n  },\n  _getConnectorPoints: function () {\n    var that = this;\n    var figure = that._figure;\n    var options = that._options;\n    var strategy = that._strategy || selectStrategy(figure);\n\n    var bBox = that._shiftBBox(that._bBoxWithoutRotation);\n\n    var rotatedBBox = that.getBoundingRect();\n    var labelPoint;\n    var points = [];\n    var isHorizontal;\n\n    if (!strategy.isLabelInside(bBox, figure, \"inside\" !== options.position)) {\n      isHorizontal = strategy.isHorizontal(bBox, figure);\n      var figureCenter = that.getFigureCenter();\n      points = strategy.prepareLabelPoints(bBox, rotatedBBox, isHorizontal, -options.rotationAngle || 0, figureCenter);\n      labelPoint = getClosestCoord(figureCenter, points);\n      points = strategy.findFigurePoint(figure, labelPoint, isHorizontal);\n      points = points.concat(labelPoint);\n    }\n\n    return strategy.adjustPoints(points);\n  },\n  fit: function (maxWidth) {\n    var padding = this._background ? 2 * LABEL_BACKGROUND_PADDING_X : 0;\n    var rowCountChanged = false;\n\n    if (this._text) {\n      var result = this._text.setMaxSize(maxWidth - padding, void 0, this._options);\n\n      var rowCount = result.rowCount;\n\n      if (0 === rowCount) {\n        rowCount = 1;\n      }\n\n      if (rowCount !== this._rowCount) {\n        rowCountChanged = true;\n        this._rowCount = rowCount;\n      }\n\n      result.textIsEmpty && disposeItem(this, \"_background\");\n    }\n\n    this._updateBackground(this._text.getBBox());\n\n    return rowCountChanged;\n  },\n  resetEllipsis: function () {\n    this._text && this._text.restoreText();\n\n    this._updateBackground(this._text.getBBox());\n  },\n  setTrackerData: function (point) {\n    this._text.data({\n      \"chart-data-point\": point\n    });\n\n    this._background && this._background.data({\n      \"chart-data-point\": point\n    });\n  },\n  hideInsideLabel: function (coords) {\n    return this._point.hideInsideLabel(this, coords);\n  },\n  getPoint: function () {\n    return this._point;\n  },\n  shift: function (x, y) {\n    var that = this;\n\n    if (that._textContent) {\n      that._insideGroup.attr({\n        translateX: that._x = _round(x - that._bBox.x),\n        translateY: that._y = _round(y - that._bBox.y)\n      });\n\n      if (that._connector) {\n        that._connector.attr({\n          points: that._getConnectorPoints()\n        });\n      }\n    }\n\n    return that;\n  },\n  getBoundingRect: function () {\n    return this._shiftBBox(this._bBox);\n  },\n  _shiftBBox: function (bBox) {\n    return this._textContent ? {\n      x: bBox.x + this._x,\n      y: bBox.y + this._y,\n      width: bBox.width,\n      height: bBox.height\n    } : {};\n  },\n  getLayoutOptions: function () {\n    var options = this._options;\n    return {\n      alignment: options.alignment,\n      background: checkBackground(options.background),\n      horizontalOffset: options.horizontalOffset,\n      verticalOffset: options.verticalOffset,\n      radialOffset: options.radialOffset,\n      position: options.position,\n      connectorOffset: (checkConnector(options.connector) ? CONNECTOR_LENGTH : 0) + (checkBackground(options.background) ? LABEL_BACKGROUND_PADDING_X : 0)\n    };\n  }\n};","map":{"version":3,"sources":["E:/Monday.com/quickstart-react/node_modules/devextreme/viz/series/points/label.js"],"names":["exports","Label","_format_helper","_interopRequireDefault","require","_utils","_iterator","_extend","obj","__esModule","_format","default","format","_math","Math","_round","round","_floor","floor","_abs","abs","CONNECTOR_LENGTH","LABEL_BACKGROUND_PADDING_X","LABEL_BACKGROUND_PADDING_Y","getClosestCoord","point","coords","closestDistance","closestCoord","each","_","coord","x","y","distance","getCrossCoord","rect","indexOffset","barPointStrategy","isLabelInside","labelPoint","figure","xc","width","yc","height","prepareLabelPoints","bBox","rotatedBBox","isHorizontal","angle","figureCenter","x1","x2","y1","y2","labelPoints","isRectangular","getFigureCenter","findFigurePoint","adjustPoints","points","lineIsVertical","lineIsHorizontal","symbolPointStrategy","r","atan2","cos","sin","piePointStrategy","_0","_1","isOutside","xl","xr","yt","yb","cosSin","getCosAndSin","map","pair","reduce","point1x","point1y","point2x","point2y","push","labelX","tan","degreesToRadians","selectStrategy","disposeItem","field","dispose","checkBackground","background","fill","stroke","checkConnector","connector","formatText","data","options","valueText","value","argumentText","argument","argumentFormat","percent","percentText","type","precision","percentPrecision","total","totalText","openValue","openValueText","closeValue","closeValueText","lowValue","lowValueText","highValue","highValueText","reductionValue","reductionValueText","customizeText","call","renderSettings","_renderer","renderer","_container","labelsGroup","_point","_strategy","strategy","_rowCount","prototype","constructor","setColor","color","_color","setOptions","_options","setData","_data","setDataField","fieldName","fieldValue","getData","setFigureToDrawConnector","_figure","that","_textContent","_visible","_insideGroup","_text","_background","_connector","_setVisibility","state","_group","attr","visibility","isVisible","hide","holdInvisible","_holdVisibility","_hide","show","holdVisible","correctPosition","_drawn","hasValue","_show","correctLabelPosition","container","text","g","append","css","attributes","patchFontOptions","font","toBackground","path","sharp","align","textAlignment","cssClass","_updateBackground","getBBox","_getLabelVisibility","draw","_bBoxWithoutRotation","extend","rotationAngle","rotate","rotateBBox","_bBox","_getConnectorPoints","_shiftBBox","getBoundingRect","position","concat","fit","maxWidth","padding","rowCountChanged","result","setMaxSize","rowCount","textIsEmpty","resetEllipsis","restoreText","setTrackerData","hideInsideLabel","getPoint","shift","translateX","_x","translateY","_y","getLayoutOptions","alignment","horizontalOffset","verticalOffset","radialOffset","connectorOffset"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (viz/series/points/label.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.Label = Label;\r\nvar _format_helper = _interopRequireDefault(require(\"../../../format_helper\"));\r\nvar _utils = require(\"../../core/utils\");\r\nvar _iterator = require(\"../../../core/utils/iterator\");\r\nvar _extend = require(\"../../../core/utils/extend\");\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\nvar _format = _format_helper.default.format;\r\nvar _math = Math;\r\nvar _round = _math.round;\r\nvar _floor = _math.floor;\r\nvar _abs = _math.abs;\r\nvar CONNECTOR_LENGTH = 12;\r\nvar LABEL_BACKGROUND_PADDING_X = 8;\r\nvar LABEL_BACKGROUND_PADDING_Y = 4;\r\n\r\nfunction getClosestCoord(point, coords) {\r\n    var closestDistance = 1 / 0;\r\n    var closestCoord;\r\n    (0, _iterator.each)(coords, function(_, coord) {\r\n        var x = point[0] - coord[0];\r\n        var y = point[1] - coord[1];\r\n        var distance = x * x + y * y;\r\n        if (distance < closestDistance) {\r\n            closestDistance = distance;\r\n            closestCoord = coord\r\n        }\r\n    });\r\n    return [_floor(closestCoord[0]), _floor(closestCoord[1])]\r\n}\r\n\r\nfunction getCrossCoord(rect, coord, indexOffset) {\r\n    return (coord - rect[0 + indexOffset]) / (rect[2 + indexOffset] - rect[0 + indexOffset]) * (rect[3 - indexOffset] - rect[1 - indexOffset]) + rect[1 - indexOffset]\r\n}\r\nvar barPointStrategy = {\r\n    isLabelInside: function(labelPoint, figure) {\r\n        var xc = labelPoint.x + labelPoint.width / 2;\r\n        var yc = labelPoint.y + labelPoint.height / 2;\r\n        return figure.x <= xc && xc <= figure.x + figure.width && figure.y <= yc && yc <= figure.y + figure.height\r\n    },\r\n    prepareLabelPoints: function(bBox, rotatedBBox, isHorizontal, angle, figureCenter) {\r\n        var x1 = rotatedBBox.x;\r\n        var xc = x1 + rotatedBBox.width / 2;\r\n        var x2 = x1 + rotatedBBox.width - 1;\r\n        var y1 = rotatedBBox.y;\r\n        var yc = y1 + rotatedBBox.height / 2;\r\n        var y2 = y1 + rotatedBBox.height - 1;\r\n        var labelPoints;\r\n        var isRectangular = _abs(angle) % 90 === 0;\r\n        if (figureCenter[0] > x1 && figureCenter[0] < x2) {\r\n            if (isRectangular) {\r\n                labelPoints = [\r\n                    [figureCenter[0], _abs(figureCenter[1] - y1) < _abs(figureCenter[1] - y2) ? y1 : y2]\r\n                ]\r\n            } else {\r\n                labelPoints = [\r\n                    [figureCenter[0], getCrossCoord([x1, y1, x2, y2], figureCenter[0], 0)]\r\n                ]\r\n            }\r\n        } else {\r\n            if (figureCenter[1] > y1 && figureCenter[1] < y2) {\r\n                if (isRectangular) {\r\n                    labelPoints = [\r\n                        [_abs(figureCenter[0] - x1) < _abs(figureCenter[0] - x2) ? x1 : x2, figureCenter[1]]\r\n                    ]\r\n                } else {\r\n                    labelPoints = [\r\n                        [getCrossCoord([x1, y1, x2, y2], figureCenter[1], 1), figureCenter[1]]\r\n                    ]\r\n                }\r\n            } else {\r\n                if (isRectangular) {\r\n                    labelPoints = [\r\n                        [x1, y1],\r\n                        [isHorizontal ? x1 : xc, isHorizontal ? yc : y1],\r\n                        [x2, y1],\r\n                        [x1, y2],\r\n                        [isHorizontal ? x2 : xc, isHorizontal ? yc : y2],\r\n                        [x2, y2]\r\n                    ]\r\n                } else {\r\n                    labelPoints = [\r\n                        [xc, yc]\r\n                    ]\r\n                }\r\n            }\r\n        }\r\n        return labelPoints\r\n    },\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x + figure.width || bBox.x + bBox.width < figure.x\r\n    },\r\n    getFigureCenter: function(figure) {\r\n        return [_floor(figure.x + figure.width / 2), _floor(figure.y + figure.height / 2)]\r\n    },\r\n    findFigurePoint: function(figure, labelPoint) {\r\n        var figureCenter = barPointStrategy.getFigureCenter(figure);\r\n        var point = getClosestCoord(labelPoint, [\r\n            [figure.x, figureCenter[1]],\r\n            [figureCenter[0], figure.y + figure.height],\r\n            [figure.x + figure.width, figureCenter[1]],\r\n            [figureCenter[0], figure.y]\r\n        ]);\r\n        return point\r\n    },\r\n    adjustPoints: function(points) {\r\n        var lineIsVertical = _abs(points[1] - points[3]) <= 1;\r\n        var lineIsHorizontal = _abs(points[0] - points[2]) <= 1;\r\n        if (lineIsHorizontal) {\r\n            points[0] = points[2]\r\n        }\r\n        if (lineIsVertical) {\r\n            points[1] = points[3]\r\n        }\r\n        return points\r\n    }\r\n};\r\nvar symbolPointStrategy = {\r\n    isLabelInside: function() {\r\n        return false\r\n    },\r\n    prepareLabelPoints: barPointStrategy.prepareLabelPoints,\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x + figure.r || bBox.x + bBox.width < figure.x - figure.r\r\n    },\r\n    getFigureCenter: function(figure) {\r\n        return [figure.x, figure.y]\r\n    },\r\n    findFigurePoint: function(figure, labelPoint) {\r\n        var angle = Math.atan2(figure.y - labelPoint[1], labelPoint[0] - figure.x);\r\n        return [_round(figure.x + figure.r * Math.cos(angle)), _round(figure.y - figure.r * Math.sin(angle))]\r\n    },\r\n    adjustPoints: barPointStrategy.adjustPoints\r\n};\r\nvar piePointStrategy = {\r\n    isLabelInside: function(_0, _1, isOutside) {\r\n        return !isOutside\r\n    },\r\n    prepareLabelPoints: function(bBox, rotatedBBox, isHorizontal, angle) {\r\n        var xl = bBox.x;\r\n        var xr = xl + bBox.width;\r\n        var xc = xl + _round(bBox.width / 2);\r\n        var yt = bBox.y;\r\n        var yb = yt + bBox.height;\r\n        var yc = yt + _round(bBox.height / 2);\r\n        var points = [\r\n            [\r\n                [xl, yt],\r\n                [xr, yt]\r\n            ],\r\n            [\r\n                [xr, yt],\r\n                [xr, yb]\r\n            ],\r\n            [\r\n                [xr, yb],\r\n                [xl, yb]\r\n            ],\r\n            [\r\n                [xl, yb],\r\n                [xl, yt]\r\n            ]\r\n        ];\r\n        var cosSin = (0, _utils.getCosAndSin)(angle);\r\n        if (0 === angle) {\r\n            points = isHorizontal ? [\r\n                [xl, yc],\r\n                [xr, yc]\r\n            ] : [\r\n                [xc, yt],\r\n                [xc, yb]\r\n            ]\r\n        } else {\r\n            points = points.map(function(pair) {\r\n                return pair.map(function(point) {\r\n                    return [_round((point[0] - xc) * cosSin.cos + (point[1] - yc) * cosSin.sin + xc), _round(-(point[0] - xc) * cosSin.sin + (point[1] - yc) * cosSin.cos + yc)]\r\n                })\r\n            }).reduce(function(r, pair) {\r\n                var point1x = pair[0][0];\r\n                var point1y = pair[0][1];\r\n                var point2x = pair[1][0];\r\n                var point2y = pair[1][1];\r\n                if (isHorizontal) {\r\n                    if (point1y >= yc && yc >= point2y || point1y <= yc && yc <= point2y) {\r\n                        r.push([(yc - point1y) * (point2x - point1x) / (point2y - point1y) + point1x, yc])\r\n                    }\r\n                } else {\r\n                    if (point1x >= xc && xc >= point2x || point1x <= xc && xc <= point2x) {\r\n                        r.push([xc, (xc - point1x) * (point2y - point1y) / (point2x - point1x) + point1y])\r\n                    }\r\n                }\r\n                return r\r\n            }, [])\r\n        }\r\n        return points\r\n    },\r\n    isHorizontal: function(bBox, figure) {\r\n        return bBox.x > figure.x || figure.x > bBox.x + bBox.width\r\n    },\r\n    getFigureCenter: symbolPointStrategy.getFigureCenter,\r\n    findFigurePoint: function(figure, labelPoint, isHorizontal) {\r\n        if (!isHorizontal) {\r\n            return [figure.x, figure.y]\r\n        }\r\n        var labelX = labelPoint[0];\r\n        var x = _round(figure.x + (figure.y - labelPoint[1]) / Math.tan((0, _utils.degreesToRadians)(figure.angle)));\r\n        var points = [figure.x, figure.y, x, labelPoint[1]];\r\n        if (!(figure.x <= x && x <= labelX) && !(labelX <= x && x <= figure.x)) {\r\n            if (_abs(figure.x - labelX) < CONNECTOR_LENGTH) {\r\n                points = [figure.x, figure.y]\r\n            } else {\r\n                if (figure.x <= labelX) {\r\n                    points[2] = figure.x + CONNECTOR_LENGTH\r\n                } else {\r\n                    points[2] = figure.x - CONNECTOR_LENGTH\r\n                }\r\n            }\r\n        }\r\n        return points\r\n    },\r\n    adjustPoints: function(points) {\r\n        return points\r\n    }\r\n};\r\n\r\nfunction selectStrategy(figure) {\r\n    return void 0 !== figure.angle && piePointStrategy || void 0 !== figure.r && symbolPointStrategy || barPointStrategy\r\n}\r\n\r\nfunction disposeItem(obj, field) {\r\n    obj[field] && obj[field].dispose();\r\n    obj[field] = null\r\n}\r\n\r\nfunction checkBackground(background) {\r\n    return background && (background.fill && \"none\" !== background.fill || background[\"stroke-width\"] > 0 && background.stroke && \"none\" !== background.stroke)\r\n}\r\n\r\nfunction checkConnector(connector) {\r\n    return connector && connector[\"stroke-width\"] > 0 && connector.stroke && \"none\" !== connector.stroke\r\n}\r\n\r\nfunction formatText(data, options) {\r\n    var format = options.format;\r\n    data.valueText = _format(data.value, format);\r\n    data.argumentText = _format(data.argument, options.argumentFormat);\r\n    if (void 0 !== data.percent) {\r\n        data.percentText = _format(data.percent, {\r\n            type: \"percent\",\r\n            precision: format && format.percentPrecision\r\n        })\r\n    }\r\n    if (void 0 !== data.total) {\r\n        data.totalText = _format(data.total, format)\r\n    }\r\n    if (void 0 !== data.openValue) {\r\n        data.openValueText = _format(data.openValue, format)\r\n    }\r\n    if (void 0 !== data.closeValue) {\r\n        data.closeValueText = _format(data.closeValue, format)\r\n    }\r\n    if (void 0 !== data.lowValue) {\r\n        data.lowValueText = _format(data.lowValue, format)\r\n    }\r\n    if (void 0 !== data.highValue) {\r\n        data.highValueText = _format(data.highValue, format)\r\n    }\r\n    if (void 0 !== data.reductionValue) {\r\n        data.reductionValueText = _format(data.reductionValue, format)\r\n    }\r\n    return options.customizeText ? options.customizeText.call(data, data) : data.valueText\r\n}\r\n\r\nfunction Label(renderSettings) {\r\n    this._renderer = renderSettings.renderer;\r\n    this._container = renderSettings.labelsGroup;\r\n    this._point = renderSettings.point;\r\n    this._strategy = renderSettings.strategy;\r\n    this._rowCount = 1\r\n}\r\nLabel.prototype = {\r\n    constructor: Label,\r\n    setColor: function(color) {\r\n        this._color = color\r\n    },\r\n    setOptions: function(options) {\r\n        this._options = options\r\n    },\r\n    setData: function(data) {\r\n        this._data = data\r\n    },\r\n    setDataField: function(fieldName, fieldValue) {\r\n        this._data = this._data || {};\r\n        this._data[fieldName] = fieldValue\r\n    },\r\n    getData: function() {\r\n        return this._data\r\n    },\r\n    setFigureToDrawConnector: function(figure) {\r\n        this._figure = figure\r\n    },\r\n    dispose: function() {\r\n        var that = this;\r\n        disposeItem(that, \"_group\");\r\n        that._data = that._options = that._textContent = that._visible = that._insideGroup = that._text = that._background = that._connector = that._figure = null\r\n    },\r\n    _setVisibility: function(value, state) {\r\n        this._group && this._group.attr({\r\n            visibility: value\r\n        });\r\n        this._visible = state\r\n    },\r\n    isVisible: function() {\r\n        return this._visible\r\n    },\r\n    hide: function(holdInvisible) {\r\n        this._holdVisibility = !!holdInvisible;\r\n        this._hide()\r\n    },\r\n    _hide: function() {\r\n        this._setVisibility(\"hidden\", false)\r\n    },\r\n    show: function(holdVisible) {\r\n        var correctPosition = !this._drawn;\r\n        if (this._point.hasValue()) {\r\n            this._holdVisibility = !!holdVisible;\r\n            this._show();\r\n            correctPosition && this._point.correctLabelPosition(this)\r\n        }\r\n    },\r\n    _show: function() {\r\n        var that = this;\r\n        var renderer = that._renderer;\r\n        var container = that._container;\r\n        var options = that._options || {};\r\n        var text = that._textContent = formatText(that._data, that._options) || null;\r\n        if (text) {\r\n            if (!that._group) {\r\n                that._group = renderer.g().append(container);\r\n                that._insideGroup = renderer.g().append(that._group);\r\n                that._text = renderer.text(\"\", 0, 0).append(that._insideGroup)\r\n            }\r\n            that._text.css(options.attributes ? (0, _utils.patchFontOptions)(options.attributes.font) : {});\r\n            if (checkBackground(options.background)) {\r\n                that._background = that._background || renderer.rect().append(that._insideGroup).toBackground();\r\n                that._background.attr(options.background);\r\n                that._color && that._background.attr({\r\n                    fill: that._color\r\n                })\r\n            } else {\r\n                disposeItem(that, \"_background\")\r\n            }\r\n            if (checkConnector(options.connector)) {\r\n                that._connector = that._connector || renderer.path([], \"line\").sharp().append(that._group).toBackground();\r\n                that._connector.attr(options.connector);\r\n                that._color && that._connector.attr({\r\n                    stroke: that._color\r\n                })\r\n            } else {\r\n                disposeItem(that, \"_connector\")\r\n            }\r\n            that._text.attr({\r\n                text: text,\r\n                align: options.textAlignment,\r\n                \"class\": options.cssClass\r\n            });\r\n            that._updateBackground(that._text.getBBox());\r\n            that._setVisibility(\"visible\", true);\r\n            that._drawn = true\r\n        } else {\r\n            that._hide()\r\n        }\r\n    },\r\n    _getLabelVisibility: function(isVisible) {\r\n        return this._holdVisibility ? this.isVisible() : isVisible\r\n    },\r\n    draw: function(isVisible) {\r\n        if (this._getLabelVisibility(isVisible)) {\r\n            this._show();\r\n            this._point && this._point.correctLabelPosition(this)\r\n        } else {\r\n            this._drawn = false;\r\n            this._hide()\r\n        }\r\n        return this\r\n    },\r\n    _updateBackground: function(bBox) {\r\n        var that = this;\r\n        if (that._background) {\r\n            bBox.x -= LABEL_BACKGROUND_PADDING_X;\r\n            bBox.y -= LABEL_BACKGROUND_PADDING_Y;\r\n            bBox.width += 2 * LABEL_BACKGROUND_PADDING_X;\r\n            bBox.height += 2 * LABEL_BACKGROUND_PADDING_Y;\r\n            that._background.attr(bBox)\r\n        }\r\n        that._bBoxWithoutRotation = (0, _extend.extend)({}, bBox);\r\n        var rotationAngle = that._options.rotationAngle || 0;\r\n        that._insideGroup.rotate(rotationAngle, bBox.x + bBox.width / 2, bBox.y + bBox.height / 2);\r\n        bBox = (0, _utils.rotateBBox)(bBox, [bBox.x + bBox.width / 2, bBox.y + bBox.height / 2], -rotationAngle);\r\n        that._bBox = bBox\r\n    },\r\n    getFigureCenter: function() {\r\n        var figure = this._figure;\r\n        var strategy = this._strategy || selectStrategy(figure);\r\n        return strategy.getFigureCenter(figure)\r\n    },\r\n    _getConnectorPoints: function() {\r\n        var that = this;\r\n        var figure = that._figure;\r\n        var options = that._options;\r\n        var strategy = that._strategy || selectStrategy(figure);\r\n        var bBox = that._shiftBBox(that._bBoxWithoutRotation);\r\n        var rotatedBBox = that.getBoundingRect();\r\n        var labelPoint;\r\n        var points = [];\r\n        var isHorizontal;\r\n        if (!strategy.isLabelInside(bBox, figure, \"inside\" !== options.position)) {\r\n            isHorizontal = strategy.isHorizontal(bBox, figure);\r\n            var figureCenter = that.getFigureCenter();\r\n            points = strategy.prepareLabelPoints(bBox, rotatedBBox, isHorizontal, -options.rotationAngle || 0, figureCenter);\r\n            labelPoint = getClosestCoord(figureCenter, points);\r\n            points = strategy.findFigurePoint(figure, labelPoint, isHorizontal);\r\n            points = points.concat(labelPoint)\r\n        }\r\n        return strategy.adjustPoints(points)\r\n    },\r\n    fit: function(maxWidth) {\r\n        var padding = this._background ? 2 * LABEL_BACKGROUND_PADDING_X : 0;\r\n        var rowCountChanged = false;\r\n        if (this._text) {\r\n            var result = this._text.setMaxSize(maxWidth - padding, void 0, this._options);\r\n            var rowCount = result.rowCount;\r\n            if (0 === rowCount) {\r\n                rowCount = 1\r\n            }\r\n            if (rowCount !== this._rowCount) {\r\n                rowCountChanged = true;\r\n                this._rowCount = rowCount\r\n            }\r\n            result.textIsEmpty && disposeItem(this, \"_background\")\r\n        }\r\n        this._updateBackground(this._text.getBBox());\r\n        return rowCountChanged\r\n    },\r\n    resetEllipsis: function() {\r\n        this._text && this._text.restoreText();\r\n        this._updateBackground(this._text.getBBox())\r\n    },\r\n    setTrackerData: function(point) {\r\n        this._text.data({\r\n            \"chart-data-point\": point\r\n        });\r\n        this._background && this._background.data({\r\n            \"chart-data-point\": point\r\n        })\r\n    },\r\n    hideInsideLabel: function(coords) {\r\n        return this._point.hideInsideLabel(this, coords)\r\n    },\r\n    getPoint: function() {\r\n        return this._point\r\n    },\r\n    shift: function(x, y) {\r\n        var that = this;\r\n        if (that._textContent) {\r\n            that._insideGroup.attr({\r\n                translateX: that._x = _round(x - that._bBox.x),\r\n                translateY: that._y = _round(y - that._bBox.y)\r\n            });\r\n            if (that._connector) {\r\n                that._connector.attr({\r\n                    points: that._getConnectorPoints()\r\n                })\r\n            }\r\n        }\r\n        return that\r\n    },\r\n    getBoundingRect: function() {\r\n        return this._shiftBBox(this._bBox)\r\n    },\r\n    _shiftBBox: function(bBox) {\r\n        return this._textContent ? {\r\n            x: bBox.x + this._x,\r\n            y: bBox.y + this._y,\r\n            width: bBox.width,\r\n            height: bBox.height\r\n        } : {}\r\n    },\r\n    getLayoutOptions: function() {\r\n        var options = this._options;\r\n        return {\r\n            alignment: options.alignment,\r\n            background: checkBackground(options.background),\r\n            horizontalOffset: options.horizontalOffset,\r\n            verticalOffset: options.verticalOffset,\r\n            radialOffset: options.radialOffset,\r\n            position: options.position,\r\n            connectorOffset: (checkConnector(options.connector) ? CONNECTOR_LENGTH : 0) + (checkBackground(options.background) ? LABEL_BACKGROUND_PADDING_X : 0)\r\n        }\r\n    }\r\n};\r\n"]},"metadata":{},"sourceType":"script"}