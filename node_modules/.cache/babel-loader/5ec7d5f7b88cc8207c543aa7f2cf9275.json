{"ast":null,"code":"/**\r\n * DevExtreme (exporter/excel/excel.file.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\n\"use strict\";\n\nexports.default = void 0;\n\nvar _type = require(\"../../core/utils/type\");\n\nvar _excel = _interopRequireDefault(require(\"./excel.tag_helper\"));\n\nvar _excel2 = _interopRequireDefault(require(\"./excel.cell_format_helper\"));\n\nvar _excel3 = _interopRequireDefault(require(\"./excel.fill_helper\"));\n\nvar _excel4 = _interopRequireDefault(require(\"./excel.font_helper\"));\n\nvar _excel5 = _interopRequireDefault(require(\"./excel.number_format_helper\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n\n    if (\"value\" in descriptor) {\n      descriptor.writable = true;\n    }\n\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) {\n    _defineProperties(Constructor.prototype, protoProps);\n  }\n\n  if (staticProps) {\n    _defineProperties(Constructor, staticProps);\n  }\n\n  return Constructor;\n}\n\nvar ExcelFile = function () {\n  function ExcelFile() {\n    _classCallCheck(this, ExcelFile);\n\n    this._cellFormatTags = [];\n    this._fillTags = [];\n    this._fontTags = [];\n    this._numberFormatTags = [];\n\n    this._fillTags.push(_excel3.default.tryCreateTag({\n      patternFill: {\n        patternType: \"none\"\n      }\n    }));\n  }\n\n  _createClass(ExcelFile, [{\n    key: \"registerCellFormat\",\n    value: function value(cellFormat) {\n      var result;\n\n      var cellFormatTag = _excel2.default.tryCreateTag(cellFormat, {\n        registerFill: this.registerFill.bind(this),\n        registerFont: this.registerFont.bind(this),\n        registerNumberFormat: this.registerNumberFormat.bind(this)\n      });\n\n      if ((0, _type.isDefined)(cellFormatTag)) {\n        for (var i = 0; i < this._cellFormatTags.length; i++) {\n          if (_excel2.default.areEqual(this._cellFormatTags[i], cellFormatTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          result = this._cellFormatTags.push(cellFormatTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateCellFormatsXml\",\n    value: function value() {\n      var cellFormatTagsAsXmlStringsArray = this._cellFormatTags.map(function (tag) {\n        return _excel2.default.toXml(tag);\n      });\n\n      return _excel.default.toXml(\"cellXfs\", {\n        count: cellFormatTagsAsXmlStringsArray.length\n      }, cellFormatTagsAsXmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"registerFill\",\n    value: function value(fill) {\n      var result;\n\n      var fillTag = _excel3.default.tryCreateTag(fill);\n\n      if ((0, _type.isDefined)(fillTag)) {\n        for (var i = 0; i < this._fillTags.length; i++) {\n          if (_excel3.default.areEqual(this._fillTags[i], fillTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          if (this._fillTags.length < 2) {\n            this._fillTags.push(_excel3.default.tryCreateTag({\n              patternFill: {\n                patternType: \"Gray125\"\n              }\n            }));\n          }\n\n          result = this._fillTags.push(fillTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateFillsXml\",\n    value: function value() {\n      var tagsAsXmlStringsArray = this._fillTags.map(function (tag) {\n        return _excel3.default.toXml(tag);\n      });\n\n      return _excel.default.toXml(\"fills\", {\n        count: tagsAsXmlStringsArray.length\n      }, tagsAsXmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"registerFont\",\n    value: function value(font) {\n      var result;\n\n      var fontTag = _excel4.default.tryCreateTag(font);\n\n      if ((0, _type.isDefined)(fontTag)) {\n        for (var i = 0; i < this._fontTags.length; i++) {\n          if (_excel4.default.areEqual(this._fontTags[i], fontTag)) {\n            result = i;\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          result = this._fontTags.push(fontTag) - 1;\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateFontsXml\",\n    value: function value() {\n      var xmlStringsArray = this._fontTags.map(function (tag) {\n        return _excel4.default.toXml(tag);\n      });\n\n      return _excel.default.toXml(\"fonts\", {\n        count: xmlStringsArray.length\n      }, xmlStringsArray.join(\"\"));\n    }\n  }, {\n    key: \"_convertNumberFormatIndexToId\",\n    value: function value(index) {\n      var CUSTOM_FORMAT_ID_START_VALUE = 165;\n      return CUSTOM_FORMAT_ID_START_VALUE + index;\n    }\n  }, {\n    key: \"registerNumberFormat\",\n    value: function value(numberFormat) {\n      var result;\n\n      var tag = _excel5.default.tryCreateTag(numberFormat);\n\n      if ((0, _type.isDefined)(tag)) {\n        for (var i = 0; i < this._numberFormatTags.length; i++) {\n          if (_excel5.default.areEqual(this._numberFormatTags[i], tag)) {\n            result = this._numberFormatTags[i][_excel5.default.ID_PROPERTY_NAME];\n            break;\n          }\n        }\n\n        if (void 0 === result) {\n          tag[_excel5.default.ID_PROPERTY_NAME] = this._convertNumberFormatIndexToId(this._numberFormatTags.length);\n          result = tag[_excel5.default.ID_PROPERTY_NAME];\n\n          this._numberFormatTags.push(tag);\n        }\n      }\n\n      return result;\n    }\n  }, {\n    key: \"generateNumberFormatsXml\",\n    value: function value() {\n      if (this._numberFormatTags.length > 0) {\n        var xmlStringsArray = this._numberFormatTags.map(function (tag) {\n          return _excel5.default.toXml(tag);\n        });\n\n        return _excel.default.toXml(\"numFmts\", {\n          count: xmlStringsArray.length\n        }, xmlStringsArray.join(\"\"));\n      } else {\n        return \"\";\n      }\n    }\n  }], [{\n    key: \"copyCellFormat\",\n    value: function value(source) {\n      return _excel2.default.copy(source);\n    }\n  }]);\n\n  return ExcelFile;\n}();\n\nexports.default = ExcelFile;\nmodule.exports = exports.default;","map":{"version":3,"sources":["E:/Monday.com/quickstart-react/node_modules/devextreme/exporter/excel/excel.file.js"],"names":["exports","default","_type","require","_excel","_interopRequireDefault","_excel2","_excel3","_excel4","_excel5","obj","__esModule","_classCallCheck","instance","Constructor","TypeError","_defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","_createClass","protoProps","staticProps","prototype","ExcelFile","_cellFormatTags","_fillTags","_fontTags","_numberFormatTags","push","tryCreateTag","patternFill","patternType","value","cellFormat","result","cellFormatTag","registerFill","bind","registerFont","registerNumberFormat","isDefined","areEqual","cellFormatTagsAsXmlStringsArray","map","tag","toXml","count","join","fill","fillTag","tagsAsXmlStringsArray","font","fontTag","xmlStringsArray","index","CUSTOM_FORMAT_ID_START_VALUE","numberFormat","ID_PROPERTY_NAME","_convertNumberFormatIndexToId","source","copy","module"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (exporter/excel/excel.file.js)\r\n * Version: 20.2.3\r\n * Build date: Tue Oct 20 2020\r\n *\r\n * Copyright (c) 2012 - 2020 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\n\"use strict\";\r\nexports.default = void 0;\r\nvar _type = require(\"../../core/utils/type\");\r\nvar _excel = _interopRequireDefault(require(\"./excel.tag_helper\"));\r\nvar _excel2 = _interopRequireDefault(require(\"./excel.cell_format_helper\"));\r\nvar _excel3 = _interopRequireDefault(require(\"./excel.fill_helper\"));\r\nvar _excel4 = _interopRequireDefault(require(\"./excel.font_helper\"));\r\nvar _excel5 = _interopRequireDefault(require(\"./excel.number_format_helper\"));\r\n\r\nfunction _interopRequireDefault(obj) {\r\n    return obj && obj.__esModule ? obj : {\r\n        \"default\": obj\r\n    }\r\n}\r\n\r\nfunction _classCallCheck(instance, Constructor) {\r\n    if (!(instance instanceof Constructor)) {\r\n        throw new TypeError(\"Cannot call a class as a function\")\r\n    }\r\n}\r\n\r\nfunction _defineProperties(target, props) {\r\n    for (var i = 0; i < props.length; i++) {\r\n        var descriptor = props[i];\r\n        descriptor.enumerable = descriptor.enumerable || false;\r\n        descriptor.configurable = true;\r\n        if (\"value\" in descriptor) {\r\n            descriptor.writable = true\r\n        }\r\n        Object.defineProperty(target, descriptor.key, descriptor)\r\n    }\r\n}\r\n\r\nfunction _createClass(Constructor, protoProps, staticProps) {\r\n    if (protoProps) {\r\n        _defineProperties(Constructor.prototype, protoProps)\r\n    }\r\n    if (staticProps) {\r\n        _defineProperties(Constructor, staticProps)\r\n    }\r\n    return Constructor\r\n}\r\nvar ExcelFile = function() {\r\n    function ExcelFile() {\r\n        _classCallCheck(this, ExcelFile);\r\n        this._cellFormatTags = [];\r\n        this._fillTags = [];\r\n        this._fontTags = [];\r\n        this._numberFormatTags = [];\r\n        this._fillTags.push(_excel3.default.tryCreateTag({\r\n            patternFill: {\r\n                patternType: \"none\"\r\n            }\r\n        }))\r\n    }\r\n    _createClass(ExcelFile, [{\r\n        key: \"registerCellFormat\",\r\n        value: function(cellFormat) {\r\n            var result;\r\n            var cellFormatTag = _excel2.default.tryCreateTag(cellFormat, {\r\n                registerFill: this.registerFill.bind(this),\r\n                registerFont: this.registerFont.bind(this),\r\n                registerNumberFormat: this.registerNumberFormat.bind(this)\r\n            });\r\n            if ((0, _type.isDefined)(cellFormatTag)) {\r\n                for (var i = 0; i < this._cellFormatTags.length; i++) {\r\n                    if (_excel2.default.areEqual(this._cellFormatTags[i], cellFormatTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    result = this._cellFormatTags.push(cellFormatTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateCellFormatsXml\",\r\n        value: function() {\r\n            var cellFormatTagsAsXmlStringsArray = this._cellFormatTags.map(function(tag) {\r\n                return _excel2.default.toXml(tag)\r\n            });\r\n            return _excel.default.toXml(\"cellXfs\", {\r\n                count: cellFormatTagsAsXmlStringsArray.length\r\n            }, cellFormatTagsAsXmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"registerFill\",\r\n        value: function(fill) {\r\n            var result;\r\n            var fillTag = _excel3.default.tryCreateTag(fill);\r\n            if ((0, _type.isDefined)(fillTag)) {\r\n                for (var i = 0; i < this._fillTags.length; i++) {\r\n                    if (_excel3.default.areEqual(this._fillTags[i], fillTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    if (this._fillTags.length < 2) {\r\n                        this._fillTags.push(_excel3.default.tryCreateTag({\r\n                            patternFill: {\r\n                                patternType: \"Gray125\"\r\n                            }\r\n                        }))\r\n                    }\r\n                    result = this._fillTags.push(fillTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateFillsXml\",\r\n        value: function() {\r\n            var tagsAsXmlStringsArray = this._fillTags.map(function(tag) {\r\n                return _excel3.default.toXml(tag)\r\n            });\r\n            return _excel.default.toXml(\"fills\", {\r\n                count: tagsAsXmlStringsArray.length\r\n            }, tagsAsXmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"registerFont\",\r\n        value: function(font) {\r\n            var result;\r\n            var fontTag = _excel4.default.tryCreateTag(font);\r\n            if ((0, _type.isDefined)(fontTag)) {\r\n                for (var i = 0; i < this._fontTags.length; i++) {\r\n                    if (_excel4.default.areEqual(this._fontTags[i], fontTag)) {\r\n                        result = i;\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    result = this._fontTags.push(fontTag) - 1\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateFontsXml\",\r\n        value: function() {\r\n            var xmlStringsArray = this._fontTags.map(function(tag) {\r\n                return _excel4.default.toXml(tag)\r\n            });\r\n            return _excel.default.toXml(\"fonts\", {\r\n                count: xmlStringsArray.length\r\n            }, xmlStringsArray.join(\"\"))\r\n        }\r\n    }, {\r\n        key: \"_convertNumberFormatIndexToId\",\r\n        value: function(index) {\r\n            var CUSTOM_FORMAT_ID_START_VALUE = 165;\r\n            return CUSTOM_FORMAT_ID_START_VALUE + index\r\n        }\r\n    }, {\r\n        key: \"registerNumberFormat\",\r\n        value: function(numberFormat) {\r\n            var result;\r\n            var tag = _excel5.default.tryCreateTag(numberFormat);\r\n            if ((0, _type.isDefined)(tag)) {\r\n                for (var i = 0; i < this._numberFormatTags.length; i++) {\r\n                    if (_excel5.default.areEqual(this._numberFormatTags[i], tag)) {\r\n                        result = this._numberFormatTags[i][_excel5.default.ID_PROPERTY_NAME];\r\n                        break\r\n                    }\r\n                }\r\n                if (void 0 === result) {\r\n                    tag[_excel5.default.ID_PROPERTY_NAME] = this._convertNumberFormatIndexToId(this._numberFormatTags.length);\r\n                    result = tag[_excel5.default.ID_PROPERTY_NAME];\r\n                    this._numberFormatTags.push(tag)\r\n                }\r\n            }\r\n            return result\r\n        }\r\n    }, {\r\n        key: \"generateNumberFormatsXml\",\r\n        value: function() {\r\n            if (this._numberFormatTags.length > 0) {\r\n                var xmlStringsArray = this._numberFormatTags.map(function(tag) {\r\n                    return _excel5.default.toXml(tag)\r\n                });\r\n                return _excel.default.toXml(\"numFmts\", {\r\n                    count: xmlStringsArray.length\r\n                }, xmlStringsArray.join(\"\"))\r\n            } else {\r\n                return \"\"\r\n            }\r\n        }\r\n    }], [{\r\n        key: \"copyCellFormat\",\r\n        value: function(source) {\r\n            return _excel2.default.copy(source)\r\n        }\r\n    }]);\r\n    return ExcelFile\r\n}();\r\nexports.default = ExcelFile;\r\nmodule.exports = exports.default;\r\n"]},"metadata":{},"sourceType":"script"}